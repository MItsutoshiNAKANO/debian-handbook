<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"><head><meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8" /><title
        xmlns:d="http://docbook.org/ns/docbook">6.2. Komendy aptitude i apt-get</title><link
        rel="stylesheet"
        type="text/css"
        href="Common_Content/css/default.css" /><link
        rel="stylesheet"
        media="print"
        href="Common_Content/css/print.css"
        type="text/css" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="generator"
        content="publican v4.3.1" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="package"
        content="Debian-debian-handbook-8-pl-PL-1.0-1" /><meta
        name="keywords"
        content="apt-get, apt-cache, aptitude, synaptic, sources.list, apt-cdrom" /><link
        rel="home"
        href="index.html"
        title="The Debian Administrator's Handbook" /><link
        rel="up"
        href="apt.html"
        title="Rozdział 6. Konserwacja i aktualizacje: Narzędzia APT" /><link
        rel="prev"
        href="apt.html"
        title="Rozdział 6. Konserwacja i aktualizacje: Narzędzia APT" /><link
        rel="next"
        href="sect.apt-cache.html"
        title="6.3. Komenda apt-cache" /><link
        rel="canonical"
        href="http://l.github.io/debian-handbook/html/pl-PL/sect.apt-get.html" /></head><body
      class="draft "><noscript><iframe
          src="//www.googletagmanager.com/ns.html?id=GTM-5H35QX"
          height="0"
          width="0"
          style="display:none;visibility:hidden"></iframe></noscript><script
        type="text/javascript">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&amp;l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5H35QX');</script><div
        id="banner"><a
          href="http://debian-handbook.info/get/"><span
            class="text">Download the ebook</span></a></div><p
        id="title"><a
          class="left"
          href="http://www.debian.org"><img
            alt="Product Site"
            src="Common_Content/images//image_left.png" /></a><a
          class="right"
          href="http://debian-handbook.info"><img
            alt="Documentation Site"
            src="Common_Content/images//image_right.png" /></a></p><ul
        class="docnav top"><li
          class="previous"><a
            accesskey="p"
            href="apt.html"><strong>Poprzedni</strong></a></li><li
          class="home">The Debian Administrator's Handbook</li><li
          class="next"><a
            accesskey="n"
            href="sect.apt-cache.html"><strong>Następny</strong></a></li></ul><div
        class="section"><div
          class="titlepage"><div><div><h2
                class="title"><a
                  id="sect.apt-get"></a>6.2. Komendy <code
                  class="command">aptitude</code> i <code
                  class="command">apt-get</code></h2></div></div></div><a
          id="idm140707129740880"
          class="indexterm"></a><a
          id="idm140707129739760"
          class="indexterm"></a><div
          class="para">
			APT jest szeroko zakrojonym projektem, który w swoich planach zakładał interfejs graficzny. Bazuje na bibliotece, która zawiera rdzeń aplikacji, a <code
            class="command">apt-get</code> jest pierwszym konsolowym front-endem stworzonym w ramach tego projektu.
		</div><div
          class="para">
			Później pojawiło się wiele innych interfejsów graficznych tworzonych jako zewnętrzne projekty: <code
            class="command">synaptic</code>, <code
            class="command">aptitude</code> (który zawiera zarówno interfejs konsolowy i graficzny — nawet jeżeli jeszcze nie w pełni kompletny), <code
            class="command">wajig</code>, etc. Najczęściej polecanym interfejsem, <code
            class="command">apt-get</code>, jest ten używany podczas instalacji Debiana, który będzie również używany w przykładach poniższej sekcji. Zauważ jednak, że konsolowa składnia <code
            class="command">aptitude</code> jest bardzo podobna. Miejsca, gdzie występują znaczące różnice pomiędzy <code
            class="command">apt-get</code> i <code
            class="command">aptitude</code>, zostaną szerzej opisane i wyjaśnione.
		</div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="idm140707129733488"></a>6.2.1. Inicjalizacja</h3></div></div></div><div
            class="para">
				Do każdej pracy z APTem trzeba zaktualizować listę dostępnych pakietów; może to zrobić przez wpisanie <code
              class="command">apt-get update</code>. Zależnie od dostępnej prędkości połączenia, operacja ta może chwilę zająć, ponieważ składa się na nią pobieranie pewnej liczby plików <code
              class="filename">Packages</code>/<code
              class="filename">Sources</code>/<code
              class="filename">Tłumaczenie-<em
                class="replaceable">kod-języka</em></code>, które stopniowo stawały się coraz większe razem z rozwojem Debiana (przynajmniej 10MB danych dla sekcji <code
              class="literal">main</code>). Oczywiście podczas instalacji z płyt CD-ROM nie jest wymagane żadne pobieranie — w takim przypadku ta operacja jest bardzo szybka.
			</div><a
            id="idm140707129729040"
            class="indexterm"></a><a
            id="idm140707129727920"
            class="indexterm"></a></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="idm140707129726640"></a>6.2.2. Instalacja i Usuwanie</h3></div></div></div><a
            id="idm140707129725840"
            class="indexterm"></a><a
            id="idm140707129724400"
            class="indexterm"></a><a
            id="idm140707129722960"
            class="indexterm"></a><a
            id="idm140707129721520"
            class="indexterm"></a><div
            class="para">
				Używając APTa pakiety mogą być dodawane i usuwane z systemu, odpowiednio za pomocą <code
              class="command">apt-get install <em
                class="replaceable">pakiet</em></code> i <code
              class="command">apt-get remove <em
                class="replaceable">pakiet</em></code>. W obu przypadkach APT automatycznie zainstaluje wymagane zależności lub usunie pakiety, które są zależne od usuwanego pakietu. Komenda <code
              class="command">apt-get purge <em
                class="replaceable">pakiet</em></code> obejmuje kompletną deinstalację — usuwane są również pliki konfiguracyjne.
			</div><a
            id="idm140707129717504"
            class="indexterm"></a><a
            id="idm140707129716384"
            class="indexterm"></a><a
            id="idm140707129715264"
            class="indexterm"></a><a
            id="idm140707129714144"
            class="indexterm"></a><a
            id="idm140707129713024"
            class="indexterm"></a><a
            id="idm140707129711904"
            class="indexterm"></a><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>WSKAZÓWKA</em></span> Instalowanie tego samego zestawu pakietów kilka razy</strong></p></div></div></div><div
              class="para">
				Może okazać się przydatne, aby systematycznie instalować tą samą listę pakietów na kilku komputerach. Można tego dokonać całkiem łatwo.
			</div><div
              class="para">
				Najpierw należy uzyskać listę pakietów zainstalowanych na komputerze służącym za "wzór" do skopiowania.
			</div><pre
              class="screen"><code
                class="computeroutput">$ </code><strong
                class="userinput"><code>dpkg --get-selections &gt;pkg-list</code></strong></pre><div
              class="para">
				The <code
                class="filename">pkg-list</code> file then contains the list of installed packages. Next, transfer the <code
                class="filename">pkg-list</code> file onto the computers you want to update and use the following commands:
			</div><pre
              class="screen">## Update dpkg's database of known packages
# <strong
                class="userinput"><code>avail=`mktemp`</code></strong>
# <strong
                class="userinput"><code>apt-cache dumpavail &gt; "$avail"</code></strong>
# <strong
                class="userinput"><code>dpkg --merge-avail "$avail"</code></strong>
# <strong
                class="userinput"><code>rm -f "$avail"</code></strong>
## Update dpkg's selections
# <strong
                class="userinput"><code>dpkg --set-selections &lt; pkg-list</code></strong>
## Ask apt-get to install the selected packages
# <strong
                class="userinput"><code>apt-get dselect-upgrade</code></strong></pre><div
              class="para">
				Pierwsza część komend zapisuje listę dostępnych pakietów w bazie danych dpkg, następnie <code
                class="command">dpkg --set-selections</code> przywraca zaznaczenia pakietów do instalacji, a wywołanie <code
                class="command">apt-get</code> wykonuje wymagane operacje! <code
                class="command">aptitude</code> nie posiada tej komendy.
			</div></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>WSKAZÓWKA</em></span> Usuwanie i instalacja w tym samym czasie</strong></p></div></div></div><div
              class="para">
				Możliwe jest użycie <code
                class="command">apt-get</code> (lub <code
                class="command">aptitude</code>), aby jednocześnie zainstalować pewne pakiety i usunąć inne za pomocą jednej komendy, poprzez dodanie przyrostka. W komendzie <code
                class="command">apt-get install</code> należy dodać “<code
                class="literal">-</code>” do nazwy pakietów przeznaczonych do usunięcia. W komendzie <code
                class="command">apt-get remove</code> należy dodać “<code
                class="literal">+</code>” do nazwy pakietów do zainstalowania.
			</div><div
              class="para">
				Następny przykład ukazuje dwa różne sposoby na zainstalowanie <em
                class="replaceable">pakiet1</em> i usunięcie <em
                class="replaceable">pakiet2</em>.
			</div><pre
              class="screen"># <strong
                class="userinput"><code>apt-get install <em
                    class="replaceable">package1</em> <em
                    class="replaceable">package2-</em></code></strong>
[...]
# <strong
                class="userinput"><code>apt-get remove <em
                    class="replaceable">package1+</em> <em
                    class="replaceable">package2</em></code></strong>
[...]
</pre><div
              class="para">
				Tego sposobu można użyć do wykluczenia z instalacji pakietów, które w przeciwnym razie zostałyby zainstalowane, np. jako <code
                class="literal">Rekomendowane</code>. W ogólnym przypadku mechanizm rozwiązywania zależności użyje tej informacji jako wskazówki do wyszukania alternatywnych rozwiązań.
			</div></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>WSKAZÓWKA</em></span> <code
                        class="command">apt-get --reinstall</code> i <code
                        class="command">aptitude reinstall</code></strong></p></div></div></div><a
              id="idm140707129688592"
              class="indexterm"></a><div
              class="para">
				Czasami system może zostać uszkodzony po usunięciu lub modyfikacji plików pakietu. Najłatwiejszym sposobem odzyskania tych plików jest reinstalacja danego pakietu. Niestety, system pakietowania informuje, że jest on już zainstalowany i grzecznie odmawia reinstalacji; aby tego uniknąć należy użyć opcji <code
                class="literal">--reinstall</code> dla komendy <code
                class="command">apt-get</code>. Komenda przedstawiona poniżej reinstaluje <span
                class="pkg pkg">postfix</span> nawet, jeżeli jest już obecny:
			</div><pre
              class="screen"><code
                class="computeroutput"># </code><strong
                class="userinput"><code>apt-get --reinstall install postfix</code></strong></pre><div
              class="para">
				Składnia komendy <code
                class="command">aptitude</code> jest nieco inna, ale osiąga ten sam rezultat z pomocą <code
                class="command">aptitude reinstall postfix</code>.
			</div><div
              class="para">
				Problem ten nie występuje w przypadku <code
                class="command">dpkg</code>, ale administrator rzadko korzysta z niej bezpośrednio.
			</div><div
              class="para">
				Be careful! Using <code
                class="command">apt-get --reinstall</code> to restore packages modified during an attack will certainly not recover the system as it was. <a
                class="xref"
                href="sect.dealing-with-compromised-machine.html">Sekcja 14.6, „Dealing with a Compromised Machine”</a> details the necessary steps to take with a compromised system.
			</div></div><div
            class="para">
				Jeżeli w pliku <code
              class="filename">sources.list</code> występuje kilka dystrybucji, możliwe jest wskazanie wersji pakietu do instalacji. Można zażądać konkretnej wersji używając <code
              class="command">apt-get install <em
                class="replaceable">pakiet</em>=<em
                class="replaceable">wersja</em></code>, ale zazwyczaj preferowane jest wskazanie dystrybucji jego pochodzenia (<span
              class="distribution distribution">Stabilna</span>, <span
              class="distribution distribution">Testowa</span> lub <span
              class="distribution distribution">Niestabilna</span>) — używając <code
              class="command">apt-get install <em
                class="replaceable">pakiet</em>/<em
                class="replaceable">dystrybucja</em></code>. Za pomocą tej komendy możliwe jest wrócenie do starszej wersji pakietu (jeżeli wiadomo, że działa lepiej), pod warunkiem że jest ciągle dostępna w jednym ze źródeł wskazanych w pliku <code
              class="filename">sources.list</code>. W przeciwnym razie z odsieczą przychodzi archiwum <code
              class="literal">snapshot.debian.org</code> (spójrz na fiszkę <a
              class="xref"
              href="apt.html#sidebar.snapshot.debian.org"><span
                class="emphasis"><em>IDĄĆ DALEJ</em></span> Stare wersje pakietów: <code
                class="literal">snapshot.debian.org</code></a>).
			</div><div
            class="example"><a
              id="idm140707129672320"></a><p
              class="title"><strong>Przykład 6.3. Instalacja <span
                  class="distribution distribution">niestabilnej</span> wersji <span
                  class="pkg pkg">spamassassin</span></strong></p><div
              class="example-contents"><pre
                class="screen"><code
                  class="computeroutput"># </code><strong
                  class="userinput"><code>apt-get install spamassassin/unstable</code></strong></pre></div></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>IDĄC DALEJ</em></span> Mechanizm cache plików <code
                        class="filename">.deb</code></strong></p></div></div></div><div
              class="para">
				APT keeps a copy of each downloaded <code
                class="filename">.deb</code> file in the directory <code
                class="filename">/var/cache/apt/archives/</code>. In case of frequent updates, this directory can quickly take a lot of disk space with several versions of each package; you should regularly sort through them. Two commands can be used: <code
                class="command">apt-get clean</code> entirely empties the directory; <code
                class="command">apt-get autoclean</code> only removes packages which can no longer be downloaded (because they have disappeared from the Debian mirror) and are therefore clearly useless (the configuration parameter <code
                class="literal">APT::Clean-Installed</code> can prevent the removal of <code
                class="filename">.deb</code> files that are currently installed).
			</div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="sect.apt-upgrade"></a>6.2.3. Uaktualnienie systemu</h3></div></div></div><a
            id="idm140707129662592"
            class="indexterm"></a><a
            id="idm140707129661152"
            class="indexterm"></a><a
            id="idm140707129660032"
            class="indexterm"></a><div
            class="para">
				Zaleca się regularne uaktualnienia, ponieważ zawierają one najnowsze aktualizacje dotyczące bezpieczeństwa. W celu uaktualnienia należy użyć <code
              class="command">apt-get upgrade</code> lub <code
              class="command">aptitude safe-upgrade</code> (oczywiście po <code
              class="command">apt-get update</code>). Ta komenda wyszukuje pakiety, które mogą zostać uaktualnione bez usuwania innych pakietów. Innymi słowy, celem jest zapewnienie jak najmniej inwazyjnego uaktualnienia. <code
              class="command">apt-get</code> jest nieco bardziej restrykcyjny niż <code
              class="command">aptitude</code>, ponieważ nie zezwoli na instalację pakietów, które nie były zainstalowane wcześniej.
			</div><div
            class="sidebar"><a
              id="sidebar.apt-pdiff"></a><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>WSKAZÓWKA</em></span> Uaktualnienie przyrostowe</strong></p></div></div></div><div
              class="para">
				As we explained earlier, the aim of the <code
                class="command">apt-get update</code> command is to download for each package source the corresponding <code
                class="filename">Packages</code> (or <code
                class="filename">Sources</code>) file. However, even after a <code
                class="command">bzip2</code> compression, these files can remain rather large (the <code
                class="filename">Packages.xz</code> for the <span
                class="foreignphrase"><em
                  class="foreignphrase">main</em></span> section of <span
                class="distribution distribution">Jessie</span> takes more than 6 MB). If you wish to upgrade regularly, these downloads can take up a lot of time.
			</div><div
              class="para">
				W celu przyspieszenia tego procesu APT może pobierać pliki "diff", zawierające zmiany od poprzedniej aktualizacji, zamiast całego pliku. Aby to osiągnąć, oficjalne serwery lustrzane Debiana rozprowadzają różne pliki zawierające listę różnic pomiędzy jedną wersją pliku <code
                class="filename">Packages</code> i jej następną wersją. Są one tworzone przy każdej aktualizacji archiwów i przetrzymywane do tygodnia wstecz. Każdy z plików "diff" zajmuje tylko kilka kilobajtów dla wersji <span
                class="distribution distribution">Niestabilnej</span>, więc ilość danych pobieranych podczas cotygodniowego <code
                class="command">aptitude update</code> jest zazwyczaj 10 razy mniejsza. Dla dystrybucji takich jak <span
                class="distribution distribution">Stabilny</span> i <span
                class="distribution distribution">Testowy</span>, które podlegają mniejszym zmianom, ten zysk jest nawet bardziej zauważalny.
			</div><div
              class="para">
				Jednakże czasami pobranie całego pliku <code
                class="filename">Packages</code> jest pożądane, zwłaszcza jeżeli ostatnie uaktualnienie było bardzo dawno temu i mechanizm przyrostów różnicowych niewiele by wniósł. Może być to również interesujące w przypadku posiadania bardzo szybkiego połączenia z siecią w połączeniu ze stosunkowo wolnym procesorem uaktualnianej maszyny, ponieważ więcej czasu będzie zaoszczędzone na pobieraniu w porównaniu z obliczaniem nowych wersji tych plików (zaczynając od starszych wersji i aplikując kolejne różnice). W tym celu należy użyć parametru konfiguracyjnego <code
                class="literal">Acquire::Pdiffs</code> ustawionego na <code
                class="literal">false</code>.
			</div></div><div
            class="para">
				<code
              class="command">apt-get</code> zazwyczaj wybierze najnowszy numer wersji (z wyjątkiem pakietów z <span
              class="distribution distribution">Experymentalnego</span> i <span
              class="distribution distribution">stable-backports</span>, które są domyślnie ignorowane bez względu na numer wersji). Jeżeli plik <code
              class="filename">sources.list</code> zawiera wpisy dla <span
              class="distribution distribution">Testowego</span> lub <span
              class="distribution distribution">Niestabilnego</span>, to <code
              class="command">apt-get upgrade</code> zamieni większość Twojego <span
              class="distribution distribution">Stabilnego</span> systemu na <span
              class="distribution distribution">Testowego</span> lub <span
              class="distribution distribution">Niestabilnego</span>, co niekoniecznie było w zamyśle.
			</div><div
            class="para">
				Aby wskazać, żeby <code
              class="command">apt-get</code> używał konkretnej dystrybucji w czasie wyszukiwania zmodernizowanych pakietów, należy użyć opcji <code
              class="literal">-t</code> lub <code
              class="literal">--target-release</code>, po której wpisać nazwę danej dystrybucji (na przykład: <code
              class="command">apt-get -t stable upgrade</code>). Aby oszczędzić sobie wpisywania tej opcji za każdym razem użycia <code
              class="command">apt-get</code>, można dodać wpis <code
              class="literal">APT::Default-Release "stable";</code> w pliku <code
              class="filename">/etc/apt/apt.conf.d/local</code>.
			</div><a
            id="idm140707127612864"
            class="indexterm"></a><a
            id="idm140707127611744"
            class="indexterm"></a><a
            id="idm140707127610624"
            class="indexterm"></a><div
            class="para">
				W celu ważniejszych uaktualnień, takich jak zmiana na następną wersję Debiana, należy użyć <code
              class="command">apt-get dist-upgrade</code> ("uaktualnienie dystrybucji"). Używając tej instrukcji <code
              class="command">apt-get</code> dokona całkowitego uaktualnienia, nawet jeżeli będzie musiał usunąć przestarzałe pakiety lub zainstalować nowe zależności. Poza tym jest to komenda stosowana na co dzień przez użytkowników wydania Debiana <span
              class="distribution distribution">Niestabilnego</span>, która podąża za jego ewolucją z dnia na dzień. To jest tak proste, że mówi samo za siebie: reputacja APTa została zbudowana na tej genialnej funkcjonalności.
			</div><div
            class="para">
				<code
              class="command">aptitude full-upgrade</code> jest odpowiednikiem dla <code
              class="command">aptitude</code>, jednakże <code
              class="command">dist-upgrade</code> jest również rozpoznawane (ale przestarzałe).
			</div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="sect.apt-config"></a>6.2.4. Opcje konfiguracyjne</h3></div></div></div><a
            id="idm140707127603584"
            class="indexterm"></a><a
            id="idm140707127602144"
            class="indexterm"></a><a
            id="idm140707127601024"
            class="indexterm"></a><div
            class="para">
				Poza wymienionymi wcześniej elementami konfiguracyjnymi, możliwa jest konfiguracja pewnych aspektów działania APTa poprzez dodanie instrukcji w pliku katalogu <code
              class="filename">/etc/apt/apt.conf.d/</code>. Przypomnijmy na przykład, że APT może poinstruować <code
              class="command">dpkg</code>, aby ignorował błędy kolizji plików przez dodanie instrukcji <code
              class="literal">DPkg::Options { "--force-overwrite"; }</code>.
			</div><div
            class="para">
				Jeżeli dostęp do sieci jest możliwy jedynie przez proxy, należy dodać linię podobną do <code
              class="literal">Acquire::http::proxy "http://<em
                class="replaceable">twojeproxy</em>:3128"</code>. Dla proxy FTP należy wpisać <code
              class="literal">Acquire::ftp::proxy "ftp://<em
                class="replaceable">twojeproxy</em>"</code>. Więcej opcji konfiguracyjnych można znaleźć na stronach pomocy <span
              class="citerefentry"><span
                class="refentrytitle">apt.conf</span>(5)</span> za pomocą komendy <code
              class="command">man apt.conf</code> (szczegóły korzystania ze stron pomocy można znaleźć w <a
              class="xref"
              href="solving-problems.html#sect.manual-pages">Sekcja 7.1.1, „Podręcznik systemowy”</a>).
			</div><div
            class="sidebar"><a
              id="sidebar.directory.d"></a><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>WRACAJĄC DO PODSTAW</em></span> Katalogi zakończone na <code
                        class="filename">.d</code></strong></p></div></div></div><a
              id="idm140707127591280"
              class="indexterm"></a><div
              class="para">
				Katalogi zakończone przyrostkiem <code
                class="filename">.d</code> są coraz częściej stosowane. Każdy katalog zawiera ustawienia konfiguracyjne podzielone pomiędzy wiele plików. W związku z tym wszystkie pliki w katalogu <code
                class="filename">/etc/apt/apt.conf.d/</code> to instrukcje konfiguracji APTa. APT uwzględnia je w kolejności alfabetycznej, tak więc ostatnie z nich mogą modyfikować element konfiguracyjny zdefiniowany w jednym z pierwszych.
			</div><div
              class="para">
				Taka struktura zapewnia pewną elastyczność administratorowi maszyny oraz zarządcom pakietów. Rzeczywiście, administrator może z łatwością zmienić konfigurację oprogramowania dodając w tym katalogu przygotowany wcześniej plik, bez konieczności modyfikacji istniejących. Zarządcy pakietów używają tego samego podejścia kiedy muszą dopasować konfigurację innego oprogramowania, aby zapewnić ich bezproblemowe współistnienie. Polityka Debiana wyraźnie zakazuje modyfikacji plików konfiguracyjnych innych pakietów — tylko użytkownik ma takie prawo. Przypomnijmy, że podczas uaktualnienia pakietu użytkownik otrzymuje wybór, którą wersję pliku konfiguracyjnego należy zatrzymać w przypadku wykrycia zmian. Wszelkie zewnętrzne zmiany w pliku uruchomiłyby takie zapytanie, które zastanowiłoby administratora przekonanego o tym, że nic nie zmieniał.
			</div><div
              class="para">
				Without a <code
                class="filename">.d</code> directory, it is impossible for an external package to change the settings of a program without modifying its configuration file. Instead it must invite the user to do it themselves and lists the operations to be done in the file <code
                class="filename">/usr/share/doc/<em
                  class="replaceable">package</em>/README.Debian</code>.
			</div><div
              class="para">
				W zależności od aplikacji katalog <code
                class="filename">.d</code> jest używany bezpośrednio lub zarządzany przez zewnętrzy skrypt, który scali wszystkie pliki w celu stworzenia końcowej konfiguracji. Ważne jest, aby uruchamiać ten skrypt po każdej zmianie w tym katalogu tak, aby najnowsze zmiany były brane pod uwagę. Tak samo ważne jest, aby nie pracować bezpośrednio z plikiem utworzonym automatycznie, ponieważ wszystkie zmiany zostaną utracone po ponownym uruchomieniu skryptu. Wybrana metoda (katalog <code
                class="filename">.d</code> używany bezpośrednio lub plik utworzony na jego podstawie) jest zazwyczaj podyktowana przez ograniczenia implementacyjne, ale w obu przypadkach zyski z elastyczności konfiguracji przeważają nad komplikacjami związanymi z jej obsługą. Serwer poczty Exim 4 jest przykładem metody tworzenia pliku: może być skonfigurowany przez kilka plików (<code
                class="filename">/etc/exim4/conf.d/*</code>), które są scalone w <code
                class="filename">/var/lib/exim4/config.autogenerated</code> przy użyciu komendy <code
                class="command">update-exim4.conf</code>.
			</div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="sect.apt.priorities"></a>6.2.5. Zarządzanie Priorytetami Pakietów</h3></div></div></div><div
            class="para">
				Jednym z najważniejszych aspektów w konfiguracji APTa jest zarządzanie priorytetami związanymi z każdym ze źródeł pakietów. Przykładowo, chciałbyś rozszerzyć dystrybucję o jeden lub dwa nowsze pakiety z <span
              class="distribution distribution">Testowego</span>, <span
              class="distribution distribution">Niestabilnego</span> lub <span
              class="distribution distribution">Eksperymentalnego</span>. Możliwe jest przypisanie priorytetu do każdego dostępnego pakietu (ten sam pakiet może mieć wiele priorytetów, zależnie od jego wersji lub dystrybucji, z której pochodzi). Priorytety wpływają bowiem na zachowanie APTa: dla każdego pakietu zawsze zostanie wybrana wersja z najwyższym priorytetem (z wyjątkiem przypadku, gdy jego wersja jest starsza niż zainstalowana i jego priorytet jest mniejszy niż 1000).
			</div><a
            id="idm140707127576464"
            class="indexterm"></a><a
            id="idm140707127574864"
            class="indexterm"></a><a
            id="idm140707127573904"
            class="indexterm"></a><a
            id="idm140707127572464"
            class="indexterm"></a><a
            id="idm140707127571024"
            class="indexterm"></a><a
            id="idm140707127569584"
            class="indexterm"></a><a
            id="idm140707127568464"
            class="indexterm"></a><div
            class="para">
				APT definiuje kilka domyślnych priorytetów. Każda zainstalowana wersja pakietu ma priorytet 100. Niezainstalowana wersja pakietu ma domyślnie priorytet 500, ale może zostać podniesiony do 990 jeżeli jest częścią wydania docelowego (zdefiniowanego opcją <code
              class="literal">-t</code> lub instrukcja konfiguracyjną <code
              class="literal">APT::Default-Release</code>).
			</div><div
            class="para">
				Można zmodyfikować priorytety dodając w pliku <code
              class="filename">/etc/apt/preferences</code> wpisy z nazwami danych pakietów, ich wersją, źródłem i nowym priorytetem.
			</div><div
            class="para">
				APT nigdy nie zainstaluje starej wersji pakietu (tzn. takiej, której numer wersji jest mniejszy niż aktualnie zainstalowany w systemie) z wyjątkiem przypadku kiedy jego priorytet jest wyższy niż 1000. APT zawsze zainstaluje pakiet o najwyższym priorytecie, który spełnia powyższy warunek. Jeżeli dwa pakiety maja taki sam priorytet, APT zainstaluje nowszy (ten, którego numer wersji jest wyższy). Jeżeli dwa pakiety tej samej wersji mają taki sam priorytet, ale różnią się zawartością, APT zainstaluje wersję, która nie jest jeszcze zainstalowana (ta zasada została stworzona dla pakietów, które zostały zaktualizowane bez zmieniania numeru wersji, który jest zazwyczaj wymagany).
			</div><div
            class="para">
				Mówiąc bardziej konkretnie, pakiet, którego priorytet jest mniejszy niż 0 nigdy nie zostanie zainstalowany. Pakiet o priorytecie pomiędzy 0 i 100 zostanie zainstalowany tylko wtedy, kiedy żadna wersja tego pakietu nie jest aktualnie zainstalowana. Posiadając priorytet pomiędzy 100 i 500, pakiet zostanie zainstalowany pod warunkiem, że jego nowsza wersja nie jest zainstalowana lub nie ma jej w innej dystrybucji. Pakiet o priorytecie pomiędzy 500 i 990 zostanie zainstalowany pod warunkiem, że jego nowsza wersja nie jest zainstalowana lub nie ma jej w docelowej dystrybucji. Posiadając priorytet pomiędzy 990 i 1000, pakiet zostanie zainstalowany, z wyjątkiem przypadku, kiedy zainstalowana jest jego nowsza wersja. Priorytet większy niż 1000 zawsze spowoduje zainstalowanie pakietu, nawet jeżeli wymusza to zejście do jego starszej wersji.
			</div><div
            class="para">
				When APT checks <code
              class="filename">/etc/apt/preferences</code>, it first takes into account the most specific entries (often those specifying the concerned package), then the more generic ones (including for example all the packages of a distribution). If several generic entries exist, the first match is used. The available selection criteria include the package's name and the source providing it. Every package source is identified by the information contained in a <code
              class="filename">Release</code> file that APT downloads together with the <code
              class="filename">Packages</code> files. It specifies the origin (usually “Debian” for the packages of official mirrors, but it can also be a person's or an organization's name for third-party repositories). It also gives the name of the distribution (usually <span
              class="distribution distribution">Stable</span>, <span
              class="distribution distribution">Testing</span>, <span
              class="distribution distribution">Unstable</span> or <span
              class="distribution distribution">Experimental</span> for the standard distributions provided by Debian) together with its version (for example 5.0 for Debian <span
              class="distribution distribution">Lenny</span>). Let's have a look at its syntax through some realistic case studies of this mechanism.
			</div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>SZCZEGÓLNY PRZYPADEK</em></span> Priorytet <span
                        class="distribution distribution">eksperymentalnego</span></strong></p></div></div></div><a
              id="idm140707127553936"
              class="indexterm"></a><div
              class="para">
				Jeżeli w pliku <code
                class="filename">sources.list</code> został wymieniony <span
                class="distribution distribution">Eksperymentalny</span>, to jego pakiety prawie nidgy nie zostaną zainstalowane, ponieważ ich domyślny priorytet wynosi 1. Jest to oczywiście szczególny przypadek, zaprojektowany, aby uchronić użytkowników przed przypadkowym zainstalowaniem <span
                class="distribution distribution">Eksperymentalnych</span> pakietów. Pakiety te mogą być zainstalowane tylko poprzez wpisanie <code
                class="command">aptitude install <em
                  class="replaceable">pakiet</em>/experimental</code> — użytkownicy wpisujący tę komendę powinni być świadomi zagrożenia, którego się podejmują. Jest nadal możliwe (ale <span
                class="emphasis"><em>nie</em></span> zalecane), aby traktować pakiety <span
                class="distribution distribution">Eksperymentalne</span> tak jak te z innych dystrybucji, poprzez nadanie im priorytetu 500. Można to osiągnąć przez dodanie specjalnego wpisu w <code
                class="filename">/etc/apt/preferences</code>:
			</div><div
              class="informalexample"><pre
                class="programlisting">Package: *
Pin: release a=experimental
Pin-Priority: 500
</pre></div></div><div
            class="para">
				Załóżmy, że chcesz używać tylko pakietów ze stabilnej wersji Debiana. Te dostarczane w innych wersjach nie powinny być instalowane, chyba że na bezpośrednie żądanie. Mógłbyś dodać następujące wpisy w pliku <code
              class="filename">/etc/apt/preferences</code>:
			</div><div
            class="informalexample"><pre
              class="programlisting">Package: *
Pin: release a=stable
Pin-Priority: 900

Package: *
Pin: release o=Debian
Pin-Priority: -10
</pre></div><div
            class="para">
				<code
              class="literal">a=stable</code> definiuje nazwę wybranej dystrybucji. <code
              class="literal">o=Debian</code> ogranicza zakres pakietów do tych, których źródłem jest "Debian".
			</div><div
            class="para">
				Let's now assume that you have a server with several local programs depending on the version 5.14 of Perl and that you want to ensure that upgrades will not install another version of it. You could use this entry:
			</div><div
            class="informalexample"><pre
              class="programlisting">Package: perl
Pin: version 5.14*
Pin-Priority: 1001
</pre></div><div
            class="para">
				Referencyjna dokumentacja dla tego pliku konfiguracyjnego jest dostępna na stronach pomocy <span
              class="citerefentry"><span
                class="refentrytitle">apt_preferences</span>(5)</span>, które można wyświetlić za pomocą <code
              class="command">man apt_preferences</code>.
			</div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>WSKAZÓWKA</em></span> Komentarze w pliku <code
                        class="filename">/etc/apt/preferences</code></strong></p></div></div></div><a
              id="idm140707127536896"
              class="indexterm"></a><a
              id="idm140707127535776"
              class="indexterm"></a><a
              id="idm140707127534656"
              class="indexterm"></a><div
              class="para">
				Nie istnieje oficjalna składnia do umieszczania komentarzy w pliku <code
                class="filename">/etc/apt/preferences</code>, ale można wprowadzić pewne opisy tekstowe przez dodanie jednego lub więcej pól “<code
                class="literal">Explanation</code>” na początku każdego wpisu.
			</div><div
              class="informalexample"><pre
                class="programlisting">Explanation: The package xserver-xorg-video-intel provided
Explanation: in experimental can be used safely
Package: xserver-xorg-video-intel
Pin: release a=experimental
Pin-Priority: 500
</pre></div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="sect.apt-mix-distros"></a>6.2.6. Praca z Kilkoma Dystrybucjami</h3></div></div></div><div
            class="para">
				To genialne narzędzie, jakim jest <code
              class="command">apt-get</code>, pozwala wybierać pakiety pochodzące z innych dystrybucji. Jeżeli chciałbyś na przykład po zainstalowaniu systemu <span
              class="distribution distribution">Stabilnego</span> przetestować pakiety dostępne w <span
              class="distribution distribution">Testowym</span> lub <span
              class="distribution distribution">Niestabilnym</span> nie odbiegając zbytnio od początkowego stanu systemu.
			</div><div
            class="para">
				Nawet jeżeli sporadycznie wystąpią problemy związane z mieszaniem pakietów z różnych dystrybucji, <code
              class="command">apt-get</code> bardzo dobrze zarządza ich współistnieniem i efektywnie ogranicza wynikające z tego zagrożenia. Najlepszym sposobem postępowania jest wylistowanie wszystkich dystrybucji występujących w pliku <code
              class="filename">/etc/apt/sources.list</code> (niektórzy zawsze umieszczają wszystkie trzy dystrybucje, ale należy pamiętać, że <span
              class="distribution distribution">Niestabilny</span> jest przeznaczony dla doświadczonych użytkowników) i zdefiniowanie przewodniej dystrybucji używając parametru <code
              class="literal">APT::Default-Release</code> (spójrz na <a
              class="xref"
              href="sect.apt-get.html#sect.apt-upgrade">Sekcja 6.2.3, „Uaktualnienie systemu”</a>).
			</div><div
            class="para">
				Załóżmy, że <span
              class="distribution distribution">Stabilny</span> jest przewodnią dystrybucją, ale <span
              class="distribution distribution">Testowy</span> i <span
              class="distribution distribution">Niestabilny</span> są również wymienione w pliku <code
              class="filename">sources.list</code>. W takim przypadku można użyć <code
              class="command">apt-get install <em
                class="replaceable">pakiet</em>/testing</code>, aby zainstalować pakiet z <span
              class="distribution distribution">Testowego</span>. Jeżeli instalacja nie powiedzie się z powodu niespełnionych zależności, można je spełnić w zakresie <span
              class="distribution distribution">Testowego</span> przez dodanie parametru <code
              class="literal">-t testing</code>. Oczywiście dla <span
              class="distribution distribution">Niestabilnego</span> sposób postępowania jest analogiczny.
			</div><div
            class="para">
				W tym przypadku uaktualnienia (<code
              class="command">upgrade</code> i <code
              class="command">dist-upgrade</code>) są wykonywane w zakresie <span
              class="distribution distribution">Stabilnego</span> z wyjątkiem pakietów, które już zostały uaktualnione do innej dystrybucji: będą one używać aktualizacji z danej dystrybucji. Opisane zachowanie zostanie wyjaśnione poniżej, z użyciem domyślnych priorytetów ustawianych przez APTa. Nie wahaj się używać <code
              class="command">apt-cache policy</code> (spójrz na fiszkę), aby zweryfikować wartości priorytetów.
			</div><div
            class="para">
				Wszystko to jest związane z faktem, że APT rozpatruje tylko pakiety mające większy lub równy numer wersji w porównaniu z zainstalowanym (zakładając, że nie użyto <code
              class="filename">/etc/apt/preferences</code> do wymuszenia wartości priorytetów większych niż 1000).
			</div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>WSKAZÓWKA</em></span> <code
                        class="command">apt-cache policy</code></strong></p></div></div></div><div
              class="para">
				W celu lepszego zrozumienia mechanizmu priorytetów można wykonać komendę <code
                class="command">apt-cache policy</code>, która wyświetla domyślny priorytet związany z danym źródłem pakietów. Można także użyć <code
                class="command">apt-cache policy <em
                  class="replaceable">pakiet</em></code>, aby wyświetlić priorytety wszystkich dostępnych wersji danego pakietu.
			</div></div><div
            class="para">
				Załóżmy, że zainstalowano wersję 1 pierwszego pakietu ze <span
              class="distribution distribution">Stabilnego</span>, a wersje 2 i 3 są dostępne odpowiednio w <span
              class="distribution distribution">Testowym</span> i <span
              class="distribution distribution">Niestabilnym</span>. Zainstalowana wersja ma priorytet 100, ale wersja dostępna w <span
              class="distribution distribution">Stabilnym</span> (ta sama) ma priorytet 990 (ponieważ jest częścią docelowego wydania). Pakiety w <span
              class="distribution distribution">Testowym</span> i <span
              class="distribution distribution">Niestabilnym</span> mają priorytet 500 (domyślny priorytet dla wersji niezainstalowanej). Zwycięzcą jest więc wersja 1 posiadająca priorytet 990. W związku z tym pakiet "zostaje w <span
              class="distribution distribution">Stabilnym</span>".
			</div><div
            class="para">
				Weźmy teraz przykład innego pakietu, który jest w wersji 2 i został zainstalowany z <span
              class="distribution distribution">Testowego</span>. Wersja 1 jest dostępna w <span
              class="distribution distribution">Stabilnym</span>, a wersja 3 w <span
              class="distribution distribution">Niestabilnym</span>. Wersja 1 (mająca priorytet 990 — nadal mniejsza niż 1000) jest pominięta, ponieważ jest mniejsza niż aktualnie zainstalowana. W związku z tym zostają wersje 2 i 3, obie z priorytetem 500. Postawiony przed takim wyborem, APT wybierze nowszą wersję, tą z <span
              class="distribution distribution">Niestabilnego</span>. Jeżeli nie jest pożądane, aby pakiet zainstalowany z <span
              class="distribution distribution">Testowego</span> został przeniesiony do <span
              class="distribution distribution">Niestabilnego</span>, należy przypisać priorytet niższy niż 500 (na przykład 490) pakietom pochodzącym z <span
              class="distribution distribution">Niestabilnego</span>. W celu uzyskania tego efektu można zmodyfikować plik <code
              class="filename">/etc/apt/preferences</code>:
			</div><pre
            class="programlisting">Package: *
Pin: release a=unstable
Pin-Priority: 490
</pre></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="sect.automatic-tracking"></a>6.2.7. Śledzenie Automatycznie Zainstalowanych Pakietów</h3></div></div></div><div
            class="para">
				Jedną z podstawowych funkcjonalności <code
              class="command">apt-get</code> (początkowo jedynie w <code
              class="command">aptitude</code>) jest śledzenie pakietów zainstalowanych tylko jako zależności. Te pakiety są nazywane "automatycznymi" i zawierają na przykład biblioteki.
			</div><div
            class="para">
				Posiadając tą informację, po usunięciu pakietów, zarządcy pakietów mogą wyznaczyć listę automatycznych pakietów, które nie są już potrzebne (ponieważ nie ma już "ręcznie zainstalowanych" pakietów, które ich wymagają). <code
              class="command">apt-get autoremove</code> służy do pozbycia się tych pakietów. <code
              class="command">aptitude</code> nie posiada odpowiednika tej komendy, ponieważ usuwa je automatycznie jak tylko zostaną wykryte. Oba programy pokazują wiadomość z listą pakietów, których to dotyczy.
			</div><a
            id="idm140707127489696"
            class="indexterm"></a><a
            id="idm140707127488576"
            class="indexterm"></a><a
            id="idm140707127487456"
            class="indexterm"></a><a
            id="idm140707127486336"
            class="indexterm"></a><div
            class="para">
				Dobrym nawykiem jest zaznaczanie jako automatycznych tych pakietów, które nie są bezpośrednio wymagane, dzięki czemu są one automatycznie usuwane w momencie, kiedy nie są już potrzebne. <code
              class="command">apt-mark auto <em
                class="replaceable">pakiet</em></code> zaznaczy pakiet jako automatyczny, podczas gdy <code
              class="command">apt-mark manual <em
                class="replaceable">pakiet</em></code> działa przeciwnie. <code
              class="command">aptitude markauto</code> i <code
              class="command">aptitude unmarkauto</code> działają w ten sam sposób, niemniej jednak oferują więcej możliwości zaznaczania wielu pakietów naraz (patrz <a
              class="xref"
              href="sect.apt-frontends.html#sect.aptitude">Sekcja 6.4.1, „<code
                class="command">aptitude</code>”</a>). Interaktywny, konsolowy interfejs <code
              class="command">aptitude</code> również pozwala na łatwy przegląd "flag automatyczności" wielu pakietów.
			</div><a
            id="idm140707127480896"
            class="indexterm"></a><div
            class="para">
				Niektórzy mogą być ciekawi, dlaczego pewien automatycznie zainstalowany pakiet jest obecny w systemie. W celu uzyskania tej informacji w linii komend można użyć <code
              class="command">aptitude why <em
                class="replaceable">pakiet</em></code> (<code
              class="command">apt-get</code> nie posiada analogicznej opcji):
			</div><pre
            class="screen">$ <strong
              class="userinput"><code>aptitude why python-debian</code></strong>
i   aptitude         Poleca apt-xapian-index         
i A apt-xapian-index Wymaga python-debian (&gt;= 0.1.15)
</pre><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>ALTERNATYWA</em></span> <code
                        class="command">deborphan</code> i <code
                        class="command">debfoster</code></strong></p></div></div></div><a
              id="idm140707127474944"
              class="indexterm"></a><a
              id="idm140707127473824"
              class="indexterm"></a><div
              class="para">
				W czasach, kiedy komendy <code
                class="command">apt-get</code> i <code
                class="command">aptitude</code> nie były w stanie śledzić automatycznych pakietów, istniały dwa narzędzia służące do tworzenia list niepotrzebnych pakietów: <code
                class="command">deborphan</code> i <code
                class="command">debfoster</code>.
			</div><div
              class="para">
				<code
                class="command">deborphan</code> is the most rudimentary of both. It simply scans the <code
                class="literal">libs</code> and <code
                class="literal">oldlibs</code> sections (in the absence of supplementary instructions) looking for the packages that are currently installed and that no other package depends on. The resulting list can then serve as a basis to remove unneeded packages.
			</div><div
              class="para">
				<code
                class="command">debfoster</code> stosuje bardziej złożone podejście, bardzo podobne do APTa: zarządza listą pakietów, które zostały bezpośrednio zainstalowane i zapamiętuje pakiety, które są naprawdę wymagane pomiędzy kolejnymi wywołaniami. Jeżeli w systemie pojawią się nowe pakiety i <code
                class="command">debfoster</code> nie rozpozna ich jako wymagane pakiety, to zostaną wyświetlone na ekranie razem z listą ich zależności. W takiej sytuacji program oferuje wybór: usunięcie pakietu (prawdopodobnie razem z pakietem, który od niego zależy), oznaczenie go jako bezpośrednio wymagany lub tymczasowe zignorowanie.
			</div></div></div></div><ul
        class="docnav"><li
          class="previous"><a
            accesskey="p"
            href="apt.html"><strong>Poprzedni</strong>Rozdział 6. Konserwacja i aktualizacje: Narzędzia...</a></li><li
          class="up"><a
            accesskey="u"
            href="#"><strong>Początek rozdziału</strong></a></li><li
          class="home"><a
            accesskey="h"
            href="index.html"><strong>Spis treści</strong></a></li><li
          class="next"><a
            accesskey="n"
            href="sect.apt-cache.html"><strong>Następny</strong>6.3. Komenda apt-cache</a></li></ul><div
        id="translated_pages"><ul><li><a
              href="../ar-MA/sect.apt-get.html">ar-MA</a></li><li><a
              href="../da-DK/sect.apt-get.html">da-DK</a></li><li><a
              href="../de-DE/sect.apt-get.html">de-DE</a></li><li><a
              href="../el-GR/sect.apt-get.html">el-GR</a></li><li><a
              href="../en-US/sect.apt-get.html">en-US</a></li><li><a
              href="../es-ES/sect.apt-get.html">es-ES</a></li><li><a
              href="../fa-IR/sect.apt-get.html">fa-IR</a></li><li><a
              href="../fr-FR/sect.apt-get.html">fr-FR</a></li><li><a
              href="../hr-HR/sect.apt-get.html">hr-HR</a></li><li><a
              href="../id-ID/sect.apt-get.html">id-ID</a></li><li><a
              href="../it-IT/sect.apt-get.html">it-IT</a></li><li><a
              href="../ja-JP/sect.apt-get.html">ja-JP</a></li><li><a
              href="../pl-PL/sect.apt-get.html">pl-PL</a></li><li><a
              href="../pt-BR/sect.apt-get.html">pt-BR</a></li><li><a
              href="../ro-RO/sect.apt-get.html">ro-RO</a></li><li><a
              href="../ru-RU/sect.apt-get.html">ru-RU</a></li><li><a
              href="../tr-TR/sect.apt-get.html">tr-TR</a></li><li><a
              href="../zh-CN/sect.apt-get.html">zh-CN</a></li></ul></div></body></html>
