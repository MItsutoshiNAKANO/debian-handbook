<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"><head><meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8" /><title
        xmlns:d="http://docbook.org/ns/docbook">6.8. Atualizações Automáticas</title><link
        rel="stylesheet"
        type="text/css"
        href="Common_Content/css/default.css" /><link
        rel="stylesheet"
        media="print"
        href="Common_Content/css/print.css"
        type="text/css" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="generator"
        content="publican v4.3.2" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="package"
        content="Debian-debian-handbook-8-pt-BR-1.0-1" /><meta
        name="keywords"
        content="apt, apt-get, apt-cache, aptitude, synaptic, sources.list, apt-cdrom" /><link
        rel="home"
        href="index.html"
        title="O Manual do Administrador Debian" /><link
        rel="up"
        href="apt.html"
        title="Capítulo 6. Manutenções e atualizações: As ferramentas APT" /><link
        rel="prev"
        href="sect.regular-upgrades.html"
        title="6.7. Mantendo um Sistema Atualizado" /><link
        rel="next"
        href="sect.searching-packages.html"
        title="6.9. Buscando por Pacotes" /><link
        rel="canonical"
        href="http://l.github.io/debian-handbook/html/pt-BR/sect.automatic-upgrades.html" /></head><body
      class="draft "><noscript><iframe
          src="//www.googletagmanager.com/ns.html?id=GTM-5H35QX"
          height="0"
          width="0"
          style="display:none;visibility:hidden"></iframe></noscript><script
        type="text/javascript">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&amp;l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5H35QX');</script><div
        id="banner"><a
          href="http://debian-handbook.info/get/"><span
            class="text">Download the ebook</span></a></div><p
        id="title"><a
          class="left"
          href="http://www.debian.org"><img
            alt="Product Site"
            src="Common_Content/images//image_left.png" /></a><a
          class="right"
          href="http://debian-handbook.info"><img
            alt="Documentation Site"
            src="Common_Content/images//image_right.png" /></a></p><ul
        class="docnav top"><li
          class="previous"><a
            accesskey="p"
            href="sect.regular-upgrades.html"><strong>Anterior</strong></a></li><li
          class="home">O Manual do Administrador Debian</li><li
          class="next"><a
            accesskey="n"
            href="sect.searching-packages.html"><strong>Próxima</strong></a></li></ul><div
        class="section"><div
          class="titlepage"><div><div><h2
                class="title"><a
                  id="sect.automatic-upgrades"></a>6.8. Atualizações Automáticas</h2></div></div></div><a
          id="idm139689845598784"
          class="indexterm"></a><a
          id="idm139689845597376"
          class="indexterm"></a><div
          class="para">
			Como a Falcot Corp tem muitos computadores mas pouca mão de obra, seus administradores tentam tornar as atualizações o mais automáticas possível. Os programas encarregados destes processos devem portanto rodar sem intervenção humana.
		</div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="idm139689845595744"></a>6.8.1. Configurando <code
                    class="command">dpkg</code></h3></div></div></div><div
            class="para">
				Como já mencionamos (veja a barra lateral <a
              class="xref"
              href="sect.package-meta-information.html#sidebar.questions-conffiles"><span
                class="emphasis"><em>INDO ALÉM</em></span> Evitando as perguntas do arquivo de configuração</a>), o <code
              class="command">dpkg</code> pode ser instruído a não pedir confirmação quando for substituir um arquivo de configuração (com as opções <code
              class="literal">--force-confdef --force-confold</code>). Interações podem, entretanto, vir de outras origens: algumas vêm do próprio APT, algumas são manipuladas pelo <code
              class="command">debconf</code> e algumas acontecem na linha de comando devido a scripts de configuração do pacote.
			</div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="idm139689845591744"></a>6.8.2. Configurando APT</h3></div></div></div><div
            class="para">
				No caso do APT é simples: a opção <code
              class="literal">-y</code> (ou <code
              class="literal">--assume-yes</code>) diz ao APT para considerar a resposta a todas as perguntas como sendo “sim”.
			</div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="idm139689845589408"></a>6.8.3. Configurando <code
                    class="command">debconf</code></h3></div></div></div><div
            class="para">
				o caso do <code
              class="command">debconf</code> merece mais detalhes. Este programa foi, desde sua concepção, projetado para controlar a relevância e a quantidade das perguntas mostradas ao usuário, assim como a forma como são exibidas. É por isto que sua configuração requer uma prioridade mínima para perguntas; apenas perguntas acima da prioridade mínima são exibidas. O <code
              class="command">debconf</code> supõe a resposta padrão (definida pelo mantenedor do pacote) para perguntas que ele decidiu pular.
			</div><div
            class="para">
				O outro elemento de configuração relevante é a interface usada pelo front-end. Se você escolher <code
              class="literal">noninteractive</code>, toda interface de usuário será desabilitada. Se um pacote tenta exibir uma nota informativa, ele vai ser enviado ao administrador via email.
			</div><div
            class="para">
				Para reconfigurar o <code
              class="command">debconf</code>, use a ferramenta <code
              class="command">dpkg-reconfigure</code> do pacote <span
              class="pkg pkg">debconf</span>; o comando relevante é o <code
              class="command">dpkg-reconfigure debconf</code>. Note que os valores configurados podem ser temporariamente sobreescritos com variáveis de ambiente quando necessário (por exemplo, <code
              class="varname">DEBIAN_FRONTEND</code> controla a interface, como documentado na página de manual <span
              class="citerefentry"><span
                class="refentrytitle">debconf</span>(7)</span>).
			</div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="idm139689845580720"></a>6.8.4. Lidando com Interações Via Linha de Comando</h3></div></div></div><div
            class="para">
				A última fonte de interações, e a mais difícil de esconder, são os scripts de configuração executados pelo <code
              class="command">dpkg</code>. infelizmente não existe solução padrão, e nenhuma resposta é substancialmente melhor que outra.
			</div><div
            class="para">
				The common approach is to suppress the standard input by redirecting the empty content of <code
              class="filename">/dev/null</code> into it with <code
              class="command"><em
                class="replaceable">command</em> &lt;/dev/null</code>, or to feed it with an endless stream of newlines. None of these methods is 100 % reliable, but they generally lead to the default answers being used, since most scripts consider a lack of reply as an acceptance of the default value.
			</div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="idm139689845576576"></a>6.8.5. A Combinação Miraculosa</h3></div></div></div><div
            class="para">
				Combinando os elementos anteriores, é possível projetar um scrips pequeno mas muito confiável que possa manipular atualizações automáticas.
			</div><div
            class="example"><a
              id="example.non-interactive-upgrade"></a><p
              class="title"><strong>Exemplo 6.4. Roteiro de atualização não interativa</strong></p><div
              class="example-contents"><pre
                class="programlisting">export DEBIAN_FRONTEND=noninteractive
yes '' | apt-get -y -o Dpkg::Options::="--force-confdef" -o Dpkg::Options::="--force-confold" dist-upgrade
</pre></div></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>NÁ PRÁTICA</em></span> O caso Falcot Corp</strong></p></div></div></div><div
              class="para">
				Os computadores da Falcot formam um sistema heterogêneo, com máquinas tendo muitas funções. Os administradores vão portanto pegar a solução mais relevante para cada computador.
			</div><div
              class="para">
				In practice, the servers running <span
                class="distribution distribution">Jessie</span> are configured with the “miracle combination” above, and are kept up to date automatically. Only the most critical servers (the firewalls, for instances) are set up with <code
                class="command">apticron</code>, so that upgrades always happen under the supervision of an administrator.
			</div><div
              class="para">
				The office workstations in the administrative services also run <span
                class="distribution distribution">Jessie</span>, but they are equipped with <span
                class="pkg pkg">gnome-packagekit</span>, so that users trigger the upgrades themselves. The rationale for this decision is that if upgrades happen without an explicit action, the behavior of the computer might change unexpectedly, which could cause confusion for the main users.
			</div><div
              class="para">
				No laboratório, os poucos computadores que usam <span
                class="distribution distribution">Testing</span> — para usufruir das últimas atualizações de software — também não são atualizados automaticamente. Os administradores configuraram o APT apenas para preparar as atualizações mas não para as ativarem; quando eles decidem atualizar (manualmente), a parte chata de renovar a lista de pacotes e baixar os pacotes é evitada, e os administradores podem focar na parte realmente útil.
			</div></div></div></div><ul
        class="docnav"><li
          class="previous"><a
            accesskey="p"
            href="sect.regular-upgrades.html"><strong>Anterior</strong>6.7. Mantendo um Sistema Atualizado</a></li><li
          class="up"><a
            accesskey="u"
            href="#"><strong>Acima</strong></a></li><li
          class="home"><a
            accesskey="h"
            href="index.html"><strong>Principal</strong></a></li><li
          class="next"><a
            accesskey="n"
            href="sect.searching-packages.html"><strong>Próxima</strong>6.9. Buscando por Pacotes</a></li></ul><div
        id="translated_pages"><ul><li><a
              href="../ar-MA/sect.automatic-upgrades.html">ar-MA</a></li><li><a
              href="../da-DK/sect.automatic-upgrades.html">da-DK</a></li><li><a
              href="../de-DE/sect.automatic-upgrades.html">de-DE</a></li><li><a
              href="../el-GR/sect.automatic-upgrades.html">el-GR</a></li><li><a
              href="../en-US/sect.automatic-upgrades.html">en-US</a></li><li><a
              href="../es-ES/sect.automatic-upgrades.html">es-ES</a></li><li><a
              href="../fa-IR/sect.automatic-upgrades.html">fa-IR</a></li><li><a
              href="../fr-FR/sect.automatic-upgrades.html">fr-FR</a></li><li><a
              href="../hr-HR/sect.automatic-upgrades.html">hr-HR</a></li><li><a
              href="../id-ID/sect.automatic-upgrades.html">id-ID</a></li><li><a
              href="../it-IT/sect.automatic-upgrades.html">it-IT</a></li><li><a
              href="../ja-JP/sect.automatic-upgrades.html">ja-JP</a></li><li><a
              href="../pl-PL/sect.automatic-upgrades.html">pl-PL</a></li><li><a
              href="../pt-BR/sect.automatic-upgrades.html">pt-BR</a></li><li><a
              href="../ro-RO/sect.automatic-upgrades.html">ro-RO</a></li><li><a
              href="../ru-RU/sect.automatic-upgrades.html">ru-RU</a></li><li><a
              href="../tr-TR/sect.automatic-upgrades.html">tr-TR</a></li><li><a
              href="../zh-CN/sect.automatic-upgrades.html">zh-CN</a></li></ul></div></body></html>
