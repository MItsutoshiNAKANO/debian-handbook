<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"><head><meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8" /><title
        xmlns:d="http://docbook.org/ns/docbook">6.2. aptitude, apt-get, and apt Commands</title><link
        rel="stylesheet"
        type="text/css"
        href="Common_Content/css/default.css" /><link
        rel="stylesheet"
        media="print"
        href="Common_Content/css/print.css"
        type="text/css" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="generator"
        content="publican v4.3.2" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="package"
        content="Debian-debian-handbook-8-ar-MA-1.0-1" /><meta
        name="keywords"
        content="apt, apt-get, apt-cache, aptitude, synaptic, sources.list, apt-cdrom" /><link
        rel="home"
        href="index.html"
        title="دفتر مدير دبيان" /><link
        rel="up"
        href="apt.html"
        title="فصل 6. الصيانة والتحديث: أدوات APT" /><link
        rel="prev"
        href="apt.html"
        title="فصل 6. الصيانة والتحديث: أدوات APT" /><link
        rel="next"
        href="sect.apt-cache.html"
        title="6.3. الأمر apt-cache" /><link
        rel="canonical"
        href="http://l.github.io/debian-handbook/html/ar-MA/sect.apt-get.html" /></head><body
      dir="rtl"
      class="draft "><noscript><iframe
          src="//www.googletagmanager.com/ns.html?id=GTM-5H35QX"
          height="0"
          width="0"
          style="display:none;visibility:hidden"></iframe></noscript><script
        type="text/javascript">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&amp;l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5H35QX');</script><div
        id="banner"><a
          href="http://debian-handbook.info/get/"><span
            class="text">Download the ebook</span></a></div><p
        id="title"><a
          class="left"
          href="http://www.debian.org"><img
            alt="Product Site"
            src="Common_Content/images//image_left.png" /></a><a
          class="right"
          href="http://debian-handbook.info"><img
            alt="Documentation Site"
            src="Common_Content/images//image_right.png" /></a></p><ul
        class="docnav top"><li
          class="previous"><a
            accesskey="p"
            href="apt.html"><strong>السابق</strong></a></li><li
          class="home">دفتر مدير دبيان</li><li
          class="next"><a
            accesskey="n"
            href="sect.apt-cache.html"><strong>التالي</strong></a></li></ul><div
        class="section"><div
          class="titlepage"><div><div><h2
                class="title"><a
                  id="sect.apt-get"></a>6.2. <code
                  class="command">aptitude</code>, <code
                  class="command">apt-get</code>, and <code
                  class="command">apt</code> Commands</h2></div></div></div><a
          id="idm140241672183440"
          class="indexterm"></a><a
          id="idm140241672182320"
          class="indexterm"></a><a
          id="idm140241672181200"
          class="indexterm"></a><div
          class="para">
			APT is a vast project, whose original plans included a graphical interface. It is based on a library which contains the core application, and <code
            class="command">apt-get</code> is the first front end — command-line based — which was developed within the project. <code
            class="command">apt</code> is a second command-line based front end provided by APT which overcomes some design mistakes of <code
            class="command">apt-get</code>.
		</div><div
          class="para">
			Numerous other graphical interfaces then appeared as external projects: <code
            class="command">synaptic</code>, <code
            class="command">aptitude</code> (which includes both a text mode interface and a graphical one — even if not complete yet), <code
            class="command">wajig</code>, etc. The most recommended interface, <code
            class="command">apt</code>, is the one that we will use in the examples given in this section. Note however that <code
            class="command">apt-get</code> and <code
            class="command">aptitude</code> have a very similar command line syntax. When there are major differences between <code
            class="command">apt</code>, <code
            class="command">apt-get</code> and <code
            class="command">aptitude</code>, these differences will be detailed.
		</div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="idm140241672173152"></a>6.2.1. التهيئة</h3></div></div></div><div
            class="para">
				For any work with APT, the list of available packages needs to be updated; this can be done simply through <code
              class="command">apt update</code>. Depending on the speed of your connection, the operation can take a while since it involves downloading a certain number of <code
              class="filename">Packages</code>/<code
              class="filename">Sources</code>/<code
              class="filename">Translation-<em
                class="replaceable">language-code</em></code> files, which have gradually become bigger and bigger as Debian has developed (at least 10 MB of data for the <code
              class="literal">main</code> section). Of course, installing from a CD-ROM set does not require any downloading — in this case, the operation is very fast.
			</div><a
            id="idm140241672168736"
            class="indexterm"></a><a
            id="idm140241672167616"
            class="indexterm"></a><a
            id="idm140241672166496"
            class="indexterm"></a></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="idm140241672165216"></a>6.2.2. التثبيت والإزالة</h3></div></div></div><a
            id="idm140241672164448"
            class="indexterm"></a><a
            id="idm140241672163008"
            class="indexterm"></a><a
            id="idm140241672161568"
            class="indexterm"></a><a
            id="idm140241672160128"
            class="indexterm"></a><div
            class="para">
				With APT, packages can be added or removed from the system, respectively with <code
              class="command">apt install <em
                class="replaceable">package</em></code> and <code
              class="command">apt remove <em
                class="replaceable">package</em></code>. In both cases, APT will automatically install the necessary dependencies or delete the packages which depend on the package that is being removed. The <code
              class="command">apt purge <em
                class="replaceable">package</em></code> command involves a complete uninstallation — the configuration files are also deleted.
			</div><a
            id="idm140241672116960"
            class="indexterm"></a><a
            id="idm140241672115840"
            class="indexterm"></a><a
            id="idm140241672114720"
            class="indexterm"></a><a
            id="idm140241672113600"
            class="indexterm"></a><a
            id="idm140241672112480"
            class="indexterm"></a><a
            id="idm140241672111360"
            class="indexterm"></a><a
            id="idm140241672110240"
            class="indexterm"></a><a
            id="idm140241672109120"
            class="indexterm"></a><a
            id="idm140241672108000"
            class="indexterm"></a><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>تلميح</em></span> تثبيت المجموعة نفسها من الحزم عدة مرات</strong></p></div></div></div><div
              class="para">
				قد يفيدك تثبيت قائمة الحزم نفسها عدة مرات آلياً على عدة حواسيب. يمكن عمل ذلك بسهولة كبيرة.
			</div><div
              class="para">
				أولاً، احصل على قائمة الحزم المثبتة على الحاسوب الذي سيخدمنا ”كنموذج“ نريد نسخه.
			</div><pre
              class="screen"><code
                class="computeroutput">$ </code><strong
                class="userinput"><code>dpkg --get-selections &gt;pkg-list</code></strong></pre><div
              class="para">
				The <code
                class="filename">pkg-list</code> file then contains the list of installed packages. Next, transfer the <code
                class="filename">pkg-list</code> file onto the computers you want to update and use the following commands:
			</div><pre
              class="screen">## Update dpkg's database of known packages
# <strong
                class="userinput"><code>avail=`mktemp`</code></strong>
# <strong
                class="userinput"><code>apt-cache dumpavail &gt; "$avail"</code></strong>
# <strong
                class="userinput"><code>dpkg --merge-avail "$avail"</code></strong>
# <strong
                class="userinput"><code>rm -f "$avail"</code></strong>
## Update dpkg's selections
# <strong
                class="userinput"><code>dpkg --set-selections &lt; pkg-list</code></strong>
## Ask apt-get to install the selected packages
# <strong
                class="userinput"><code>apt-get dselect-upgrade</code></strong></pre><div
              class="para">
				يسجّل الأمر الأول قائمة الحزم المتوفرة في قاعدة بيانات dpkg، بعدها يستعيد الأمر <code
                class="command">dpkg --set-selections</code> الحزم التي تريد تثبيتها، ثم نستدعي <code
                class="command">apt-get</code> لتنفيذ العمليات المطلوبة! لا تملك <code
                class="command">aptitude</code> هذا الأمر.
			</div></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>تلميح</em></span> الإزالة والتثبيت في الوقت نفسه</strong></p></div></div></div><div
              class="para">
				It is possible to ask <code
                class="command">apt</code> (or <code
                class="command">apt-get</code>, or <code
                class="command">aptitude</code>) to install certain packages and remove others on the same command line by adding a suffix. With an <code
                class="command">apt install</code> command, add “<code
                class="literal">-</code>” to the names of the packages you wish to remove. With an <code
                class="command">apt remove</code> command, add “<code
                class="literal">+</code>” to the names of the packages you wish to install.
			</div><div
              class="para">
				يبين المثال التالي طريقتين مختلفتين لتثبيت <em
                class="replaceable">package1</em> وإزالة <em
                class="replaceable">package2</em>.
			</div><pre
              class="screen"># <strong
                class="userinput"><code>apt install <em
                    class="replaceable">package1</em> <em
                    class="replaceable">package2-</em></code></strong>
[...]
# <strong
                class="userinput"><code>apt remove <em
                    class="replaceable">package1+</em> <em
                    class="replaceable">package2</em></code></strong>
[...]
</pre><div
              class="para">
				يمكن استخدام هذا الإجراء أيضاً لاستبعاد بعض الحزم التي كانت ستثبت، نتيجة <code
                class="literal">Recommends</code> مثلاً. عموماً، تستخدم خوارزمية تلبية الاعتماديات (dependency solver) هذه المعلومات كتلميح للبحث عن حلول بديلة.
			</div></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>TIP</em></span> <code
                        class="command">apt --reinstall</code> and <code
                        class="command">aptitude reinstall</code></strong></p></div></div></div><a
              id="idm140241672083808"
              class="indexterm"></a><div
              class="para">
				The system can sometimes be damaged after the removal or modification of files in a package. The easiest way to retrieve these files is to reinstall the affected package. Unfortunately, the packaging system finds that the latter is already installed and politely refuses to reinstall it; to avoid this, use the <code
                class="literal">--reinstall</code> option of the <code
                class="command">apt</code> and <code
                class="command">apt-get</code> commands. The following command reinstalls <span
                class="pkg pkg">postfix</span> even if it is already present:
			</div><pre
              class="screen"><code
                class="computeroutput"># </code><strong
                class="userinput"><code>apt --reinstall install postfix</code></strong></pre><div
              class="para">
				إن صيغة الأمر في <code
                class="command">aptitude</code> مختلفة قليلاً، لكنها تؤدي الوظيفة ذاتها باستخدام <code
                class="command">aptitude reinstall postfix</code>.
			</div><div
              class="para">
				لا تظهر هذه المشكلة مع <code
                class="command">dpkg</code>، لكن مدير النظام نادراً ما يستعمله مباشرة.
			</div><div
              class="para">
				Be careful! Using <code
                class="command">apt --reinstall</code> to restore packages modified during an attack will certainly not recover the system as it was. <a
                class="xref"
                href="sect.dealing-with-compromised-machine.html">قسم 14.7, “التعامل مع جهاز مُختَرَق”</a> details the necessary steps to take with a compromised system.
			</div></div><div
            class="para">
				If the file <code
              class="filename">sources.list</code> mentions several distributions, it is possible to give the version of the package to install. A specific version number can be requested with <code
              class="command">apt install <em
                class="replaceable">package</em>=<em
                class="replaceable">version</em></code>, but indicating its distribution of origin (<span
              class="distribution distribution">Stable</span>, <span
              class="distribution distribution">Testing</span> or <span
              class="distribution distribution">Unstable</span>) — with <code
              class="command">apt install <em
                class="replaceable">package</em>/<em
                class="replaceable">distribution</em></code> — is usually preferred. With this command, it is possible to go back to an older version of a package (if for instance you know that it works well), provided that it is still available in one of the sources referenced by the <code
              class="filename">sources.list</code> file. Otherwise the <code
              class="literal">snapshot.debian.org</code> archive can come to the rescue (see sidebar <a
              class="xref"
              href="apt.html#sidebar.snapshot.debian.org"><span
                class="emphasis"><em>التعمق أكثر</em></span> إصدارات الحزم القديمة: <code
                class="literal">snapshot.debian.org</code></a>).
			</div><div
            class="example"><a
              id="idm140241672067120"></a><p
              class="title"><strong>مثال 6.3. تثبيت النسخة <span
                  class="distribution distribution">غير المستقرة</span> من <span
                  class="pkg pkg">spamassassin</span></strong></p><div
              class="example-contents"><pre
                class="screen"><code
                  class="computeroutput"># </code><strong
                  class="userinput"><code>apt install spamassassin/unstable</code></strong></pre></div></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>التعمق أكثر</em></span> مخبأ ملفات <code
                        dir="ltr"
                        class="filename">.deb</code></strong></p></div></div></div><div
              class="para">
				APT keeps a copy of each downloaded <code
                class="filename">.deb</code> file in the directory <code
                class="filename">/var/cache/apt/archives/</code>. In case of frequent updates, this directory can quickly take a lot of disk space with several versions of each package; you should regularly sort through them. Two commands can be used: <code
                class="command">apt-get clean</code> entirely empties the directory; <code
                class="command">apt-get autoclean</code> only removes packages which can no longer be downloaded (because they have disappeared from the Debian mirror) and are therefore clearly useless (the configuration parameter <code
                class="literal">APT::Clean-Installed</code> can prevent the removal of <code
                class="filename">.deb</code> files that are currently installed). Note that <code
                class="command">apt</code> does not support those commands.
			</div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="sect.apt-upgrade"></a>6.2.3. تحديث النظام</h3></div></div></div><a
            id="idm140241672056640"
            class="indexterm"></a><a
            id="idm140241672055200"
            class="indexterm"></a><a
            id="idm140241672054080"
            class="indexterm"></a><a
            id="idm140241672052960"
            class="indexterm"></a><div
            class="para">
				Regular upgrades are recommended, because they include the latest security updates. To upgrade, use <code
              class="command">apt upgrade</code>, <code
              class="command">apt-get upgrade</code> or <code
              class="command">aptitude safe-upgrade</code> (of course after <code
              class="command">apt update</code>). This command looks for installed packages which can be upgraded without removing any packages. In other words, the goal is to ensure the least intrusive upgrade possible. <code
              class="command">apt-get</code> is slightly more demanding than <code
              class="command">aptitude</code> or <code
              class="command">apt</code> because it will refuse to install packages which were not installed beforehand.
			</div><div
            class="sidebar"><a
              id="sidebar.apt-pdiff"></a><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>تلميح</em></span> التحديث التصاعدي</strong></p></div></div></div><div
              class="para">
				As we explained earlier, the aim of the <code
                class="command">apt update</code> command is to download for each package source the corresponding <code
                class="filename">Packages</code> (or <code
                class="filename">Sources</code>) file. However, even after a <code
                class="command">bzip2</code> compression, these files can remain rather large (the <code
                class="filename">Packages.xz</code> for the <span
                class="foreignphrase"><em
                  class="foreignphrase">main</em></span> section of <span
                class="distribution distribution">Jessie</span> takes more than 6 MB). If you wish to upgrade regularly, these downloads can take up a lot of time.
			</div><div
              class="para">
				To speed up the process APT can download “diff” files containing the changes since the previous update, as opposed to the entire file. To achieve this, official Debian mirrors distribute different files which list the differences between one version of the <code
                class="filename">Packages</code> file and the following version. They are generated at each update of the archives and a history of one week is kept. Each of these “diff” files only takes a few dozen kilobytes for <span
                class="distribution distribution">Unstable</span>, so that the amount of data downloaded by a weekly <code
                class="command">apt update</code> is often divided by 10. For distributions like <span
                class="distribution distribution">Stable</span> and <span
                class="distribution distribution">Testing</span>, which change less, the gain is even more noticeable.
			</div><div
              class="para">
				على أي حال، قد ترغب أحياناً بتنزيل ملف <code
                class="filename">Packages</code> بالكامل قسراً، خصوصاً عندما يكون آخر تحديث قديماً جداً وعندما لا تفيد آلية الاختلافات التصاعدية كثيراً. قد يعجبك هذا أيضاً عندما يكون اتصالك بالشبكة سريعاً جداً لكن معالج الجهاز الذي تريد تحديثه بطيء، نظراً لأن الوقت الذي ستوفره من تنزيل الملفات أقل من الوقت الذي يضيعه الحاسوب في حساب الإصدارات الجديدة لهذه الملفات (يحسبها من الإصدارات القديمة بتطبيق الاختلافات المنزّلة عليها). لعمل ذلك، يمكنك استخدام متغير الإعداد <code
                class="literal">Acquire::Pdiffs</code> وضبطه على <code
                class="literal">false</code>.
			</div></div><div
            class="para">
				<code
              class="command">apt</code> will generally select the most recent version number (except for packages from <span
              class="distribution distribution">Experimental</span> and <span
              class="distribution distribution">stable-backports</span>, which are ignored by default whatever their version number). If you specified <span
              class="distribution distribution">Testing</span> or <span
              class="distribution distribution">Unstable</span> in your <code
              class="filename">sources.list</code>, <code
              class="command">apt upgrade</code> will switch most of your <span
              class="distribution distribution">Stable</span> system to <span
              class="distribution distribution">Testing</span> or <span
              class="distribution distribution">Unstable</span>, which might not be what you intended.
			</div><div
            class="para">
				To tell <code
              class="command">apt</code> to use a specific distribution when searching for upgraded packages, you need to use the <code
              class="literal">-t</code> or <code
              class="literal">--target-release</code> option, followed by the name of the distribution you want (for example: <code
              class="command">apt -t stable upgrade</code>). To avoid specifying this option every time you use <code
              class="command">apt</code>, you can add <code
              class="literal">APT::Default-Release "stable";</code> in the file <code
              class="filename">/etc/apt/apt.conf.d/local</code>.
			</div><a
            id="idm140241672024080"
            class="indexterm"></a><a
            id="idm140241672022960"
            class="indexterm"></a><a
            id="idm140241672021840"
            class="indexterm"></a><a
            id="idm140241672020720"
            class="indexterm"></a><a
            id="idm140241672019600"
            class="indexterm"></a><div
            class="para">
				For more important upgrades, such as the change from one major Debian version to the next, you need to use <code
              class="command">apt full-upgrade</code>. With this instruction, <code
              class="command">apt</code> will complete the upgrade even if it has to remove some obsolete packages or install new dependencies. This is also the command used by users who work daily with the Debian <span
              class="distribution distribution">Unstable</span> release and follow its evolution day by day. It is so simple that it hardly needs explanation: APT's reputation is based on this great functionality.
			</div><div
            class="para">
				Unlike <code
              class="command">apt</code> and <code
              class="command">aptitude</code>, <code
              class="command">apt-get</code> doesn't know the <code
              class="command">full-upgrade</code> command. Instead, you should use <code
              class="command">apt-get dist-upgrade</code> (”distribution upgrade”), the historical and well-known command that <code
              class="command">apt</code> and <code
              class="command">aptitude</code> also accept for the convenience of users who got used to it.
			</div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="sect.apt-config"></a>6.2.4. خيارات الإعداد</h3></div></div></div><a
            id="idm140241672010768"
            class="indexterm"></a><a
            id="idm140241672009328"
            class="indexterm"></a><a
            id="idm140241672008208"
            class="indexterm"></a><div
            class="para">
				بالإضافة إلى عناصر الضبط التي ذكرناها سابقاً، من الممكن ضبط بعض نواحي APT بإضافة تعليمات في ملف في مجلد <code
              class="filename">/etc/apt/apt.conf.d/</code>. تذكر مثلاً أن APT تستطيع الطلب من <code
              class="command">dpkg</code> تجاهل أخطاء تعارض الملفات بتحديد <code
              dir="ltr"
              class="literal">DPkg::Options { "--force-overwrite"; }</code>.
			</div><div
            class="para">
				إذا لم يكن الوصول للوب ممكناً إلا من خلال بروكسي، أضف سطراً مثل <code
              class="literal">Acquire::http::proxy "http://<em
                class="replaceable">yourproxy</em>:3128"</code>‎. أما بالنسبة لبروكسيات FTP فاكتب <code
              class="literal">Acquire::ftp::proxy "ftp://<em
                class="replaceable">yourproxy</em>"</code>‎. لاكتشاف المزيد من خيارات الضبط، اقرأ صفحة الدليل <span
              class="citerefentry"><span
                class="refentrytitle">apt.conf</span>(5)</span>‎ باستخدام الأمر <code
              class="command">man apt.conf</code> (لمزيد من التفاصيل عن صفحات الدليل، انظر <a
              class="xref"
              href="solving-problems.html#sect.manual-pages">قسم 7.1.1, “صفحات الدليل”</a>).
			</div><div
            class="sidebar"><a
              id="sidebar.directory.d"></a><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>أساسيات</em></span> المجلدات التي تنتهي باللاحقة <code
                        dir="ltr"
                        class="filename">.d</code></strong></p></div></div></div><a
              id="idm140241671997808"
              class="indexterm"></a><div
              class="para">
				أصبح استخدام المجلدات ذات اللاحقة <code
                dir="ltr"
                class="filename">.d</code> ينتشر أكثر وأكثر. يعبّر كل مجلد عن ملف إعداد مقسّم إلى عدة ملفات. هذا يعني أن جميع الملفات في مجلد <code
                dir="ltr"
                class="filename">/etc/apt/apt.conf.d/</code> هي تعليمات ضبط APT. تُضَمِّن APT هذه الملفات حسب الترتيب الأبجدي، بحيث أن الملفات الأخيرة تستطيع تعديل عناصر الضبط المعرّفة في الملفات الأولى.
			</div><div
              class="para">
				تمنح هذه البنية بعض المرونة لمدير النظام ولمشرفي الحزم. حقاً، يمكن أن يعدل مدير النظام إعدادات البرنامج بإضافة ملف جاهز في المجلد المطلوب دون الاضطرار لتعديل ملف موجود مسبقاً. يستخدم مشرفو الحزم نفس الأسلوب عندما يحتاجون لمواءمة إعدادات برنامج آخر للتأكد من أنه ينسجم تماماً مع برامجهم. تحظر سياسة دبيان بشكل صريح تعديل ملفات ضبط الحزم الأخرى — ولا يُسمَح إلا للمستخدمين فقط بذلك. تذكر أنه خلال تحديث الحزمة، يجب على المستخدم أن يختار نسخة ملف الإعداد التي يجب الاحتفاظ بها عند اكتشاف حدوث تغيرات. أي تغيير خارجي على الملف سوف ينشط ذلك الطلب، وهو ما يزعج مدير النظام، خصوصاً أنه متأكد من أنه لم يغير شيئاً.
			</div><div
              class="para">
				Without a <code
                class="filename">.d</code> directory, it is impossible for an external package to change the settings of a program without modifying its configuration file. Instead it must invite the user to do it themselves and lists the operations to be done in the file <code
                class="filename">/usr/share/doc/<em
                  class="replaceable">package</em>/README.Debian</code>.
			</div><div
              class="para">
				اعتماداً على البرنامج، إما أن يُستَخدم مجلد <code
                dir="ltr"
                class="filename">.d</code> مباشرة أو يُدار بوساطة سكربت خارجي يدمج جميع الملفات لإنشاء ملف الإعداد نفسه. من المهم تشغيل السكربت بعد أي تغيير في ذلك المجلد حتى تُأخَذ التعديلات الأحدث بعين الاعتبار. من المهم أيضاً ألا تُجرى تعديلات على ملف الإعدادات الذي ينشئه السكربت تلقائياً، لأن كل شيء سيضيع عند التنفيذ التالي للسكربت. عادة ما يُفرَض استخدام إحدى الطريقتين (استخدام المجلد <code
                dir="ltr"
                class="filename">.d</code> مباشرة أو استخدام ملف مولد من ذلك المجلد) نتيجة قيود ناجمة عن طريقة التطبيق (implementation)، لكن في كلا الحالتين يعوّض الكسب في مرونة الإعداد عن التعقيدات الصغيرة الناتجة. مخدّم البريد Exim 4 هو مثال عن طريقة الملف المولَّد: حيث يمكن إعداده من خلال عدة ملفات (<code
                dir="ltr"
                class="filename">/etc/exim4/conf.d/*</code>) يجمعها الأمر <code
                class="command">update-exim4.conf</code> في الملف <code
                dir="ltr"
                class="filename">/var/lib/exim4/config.autogenerated</code>.
			</div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="sect.apt.priorities"></a>6.2.5. إدارة أولويات الحزم</h3></div></div></div><div
            class="para">
				إدارة الأولويات المرتبطة بكل مصدر للحزم هي إحدى أهم النواحي في إعدادات APT. مثلاً، قد ترغب بإضافة حزمة واحدة أو اثنتين من التوزيعة <span
              class="distribution distribution">الاختبارية</span>، أو <span
              class="distribution distribution">غير المستقرة</span> أو <span
              class="distribution distribution">التجريبية</span> إلى إحدى التوزيعات الأخرى. من الممكن تعيين أولويات للحزم المتوفرة (يمكن أن تملك الحزمة الواحدة أكثر من أولوية واحدة اعتماداً على إصدارها أو التوزيعة التي توفرها). ستؤثر هذه الأولويات في سلوك APT: ستختار دائماً نسخة الحزمة ذات الأولوية الأعلى (إلا إذا كانت هذه النسخة أقدم من النسخة المثبتة وكانت أولويتها أقل من 1000).
			</div><a
            id="idm140241671980368"
            class="indexterm"></a><a
            id="idm140241671978768"
            class="indexterm"></a><a
            id="idm140241671977808"
            class="indexterm"></a><a
            id="idm140241671976368"
            class="indexterm"></a><a
            id="idm140241671974960"
            class="indexterm"></a><a
            id="idm140241671973520"
            class="indexterm"></a><a
            id="idm140241671972400"
            class="indexterm"></a><div
            class="para">
				تُعرِّف APT عدة أولويات افتراضية. كل نسخة مثبتة من الحزمة لها أولوية تساوي 100. النسخة غير المثبتة لها أولوية تساوي 500 افتراضياً، لكن يمكنها أن تقفز إلى 990 إذا كانت تنتمي للتوزيعة المستهدفة (التي تُحدَّد بالخيار <code
              dir="ltr"
              class="literal">-t</code> أو تعليمة الضبط <code
              class="literal">APT::Default-Release</code>).
			</div><div
            class="para">
				يمكنك تغيير الأولويات بإضافة مدخلات بأسماء الحزم المتأثرة، وإصداراتها، ومصدرها وأولوياتها الجديدة إلى الملف <code
              dir="ltr"
              class="filename">/etc/apt/preferences</code>.
			</div><div
            class="para">
				لن تثبت APT أبداً نسخة أقدم من الحزمة (نسخة يكون رقم إصدارها أقل من الحزمة المثبتة حالياً) إلا إذا كانت أولويتها أعلى من 1000. ستُثَـبّت APT دائماً الحزمة ذات الأولوية العليا التي تحقق هذا الشرط. إذا كان لحزمتين الأولوية نفسها، تثبت APT النسخة الأحدث (ذات رقم الإصدار الأعلى). إذا كان لحزمتين الإصدار نفسه والأولوية نفسها لكنهما تختلفان في محتواهما، تثبّت APT النسخة غير المثبتة (تم وضع هذه القاعدة لتغطية الحالة التي تُحدَّث فيها الحزمة دون زيادة رقم مراجعتها، فالحاجة تدعو لهذا الأمر عادة).
			</div><div
            class="para">
				بكلمات مترابطة أكثر، الحزمة ذات الأولوية الأدنى من 0 لن تثبت أبداً. أما الحزمة ذات الأولوية بين 0 و 100 فسوف تُثبَّت فقط إذا لم تكن هناك نسخة أخرى من الحزمة مثبتة مسبقاً. وتُثبَّت الحزمة ذات الأولوية بين 100 و 500 فقط إذا لم تكن هناك نسخ أحدث منها مثبتة أو متوفرة في توزيعة أخرى. أما الحزمة ذات الأولوية بين 501 و 990 فتُثَـبَّت فقط إذا لم تكن هناك نسخة أحدث مثبتة أو متوفرة في التوزيعة المستهدفة. الحزمة ذات الأولوية ما بين 990 و 1000 تثبت دائماً إلا إذا كانت النسخة المثبتة أحدث منها. الأولوية الأكبر من 1000 ستؤدي دائماً إلى تثبيت الحزمة حتى لو أجبرت APT على تخفيض الحزمة إلى نسخة أقدم.
			</div><div
            class="para">
				When APT checks <code
              class="filename">/etc/apt/preferences</code>, it first takes into account the most specific entries (often those specifying the concerned package), then the more generic ones (including for example all the packages of a distribution). If several generic entries exist, the first match is used. The available selection criteria include the package's name and the source providing it. Every package source is identified by the information contained in a <code
              class="filename">Release</code> file that APT downloads together with the <code
              class="filename">Packages</code> files. It specifies the origin (usually “Debian” for the packages of official mirrors, but it can also be a person's or an organization's name for third-party repositories). It also gives the name of the distribution (usually <span
              class="distribution distribution">Stable</span>, <span
              class="distribution distribution">Testing</span>, <span
              class="distribution distribution">Unstable</span> or <span
              class="distribution distribution">Experimental</span> for the standard distributions provided by Debian) together with its version (for example 8 for Debian <span
              class="distribution distribution">Jessie</span>). Let's have a look at its syntax through some realistic case studies of this mechanism.
			</div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>حالة خاصة</em></span> أولوية الحزم <span
                        class="distribution distribution">التجريبية</span></strong></p></div></div></div><a
              id="idm140241671956592"
              class="indexterm"></a><div
              class="para">
				إذا أضفت التوزيعة <span
                class="distribution distribution">التجريبية</span> إلى ملف <code
                class="filename">sources.list</code>، فإن حزمها لن تثبت أبداً تقريباً لأن أولويتها الافتراضية هي 1. هذه حالة خاصة بالطبع، مصممة لحماية المستخدمين من تثبيت الحزم <span
                class="distribution distribution">التجريبية</span> بالخطأ. يمكن تثبيت هذه الحزم فقط بكتابة <code
                class="command">aptitude install <em
                  class="replaceable">package</em>/experimental</code> — لأن المستخدمين الذين سيكتبون هذا الأمر هم وحدهم الذين يدركون المخاطر التي يعرضون أنفسهم لها. من الممكن مع ذلك (رغم أن هذا <span
                class="emphasis"><em>غير</em></span> مستحسن) معاملة حزم التوزيعة <span
                class="distribution distribution">التجريبية</span> مثل حزم التوزيعات الأخرى بإعطائها الأولوية 500. يتم هذا من خلال مدخلة خاصة في <code
                dir="ltr"
                class="filename">/etc/apt/preferences</code>:
			</div><div
              class="informalexample"><pre
                class="programlisting">Package: *
Pin: release a=experimental
Pin-Priority: 500
</pre></div></div><div
            class="para">
				لنفترض أنك تريد استعمال الحزم من النسخة المستقرة من دبيان فقط. وأن تلك الحزم المتوفرة في الإصدارات الأخرى يجب ألا تثبت إلا إذا طلبت صراحة. يمكن كتابة المدخلات التالية في ملف <code
              dir="ltr"
              class="filename">/etc/apt/preferences</code>:
			</div><div
            class="informalexample"><pre
              class="programlisting">Package: *
Pin: release a=stable
Pin-Priority: 900

Package: *
Pin: release o=Debian
Pin-Priority: -10
</pre></div><div
            class="para">
				يُعرِّف <code
              class="literal">a=stable</code> اسم التوزيعة المختارة. ويَقْصُر <code
              class="literal">o=Debian</code> المجال على الحزم ذات المنشأ ”Debian“.
			</div><div
            class="para">
				Let's now assume that you have a server with several local programs depending on the version 5.14 of Perl and that you want to ensure that upgrades will not install another version of it. You could use this entry:
			</div><div
            class="informalexample"><pre
              class="programlisting">Package: perl
Pin: version 5.14*
Pin-Priority: 1001
</pre></div><div
            class="para">
				الوثائق المرجعية لملف الضبط هذا متوفرة في صفحة الدليل <span
              class="citerefentry"><span
                class="refentrytitle">apt_preferences</span>(5)</span>‎، التي يمكن عرضها بالأمر <code
              class="command">man apt_preferences</code>.
			</div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>تلميح</em></span> التعليقات في الملف <code
                        dir="ltr"
                        class="filename">/etc/apt/preferences</code></strong></p></div></div></div><a
              id="idm140241671938400"
              class="indexterm"></a><a
              id="idm140241671937280"
              class="indexterm"></a><a
              id="idm140241671936160"
              class="indexterm"></a><div
              class="para">
				لا توجد صيغة رسمية للتعليقات في ملف <code
                dir="ltr"
                class="filename">/etc/apt/preferences</code>، لكن يمكن تقديم بعض الأوصاف النصية بوضع حقل”<code
                class="literal">Explanation</code>“ أو أكثر في بداية كل مدخلة:
			</div><div
              class="informalexample"><pre
                class="programlisting">Explanation: The package xserver-xorg-video-intel provided
Explanation: in experimental can be used safely
Package: xserver-xorg-video-intel
Pin: release a=experimental
Pin-Priority: 500
</pre></div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="sect.apt-mix-distros"></a>6.2.6. العمل مع عدة توزيعات</h3></div></div></div><div
            class="para">
				<code
              class="command">apt</code> being such a marvelous tool, it is tempting to pick packages coming from other distributions. For example, after having installed a <span
              class="distribution distribution">Stable</span> system, you might want to try out a software package available in <span
              class="distribution distribution">Testing</span> or <span
              class="distribution distribution">Unstable</span> without diverging too much from the system's initial state.
			</div><div
            class="para">
				Even if you will occasionally encounter problems while mixing packages from different distributions, <code
              class="command">apt</code> manages such coexistence very well and limits risks very effectively. The best way to proceed is to list all distributions used in <code
              class="filename">/etc/apt/sources.list</code> (some people always put the three distributions, but remember that <span
              class="distribution distribution">Unstable</span> is reserved for experienced users) and to define your reference distribution with the <code
              class="literal">APT::Default-Release</code> parameter (see <a
              class="xref"
              href="sect.apt-get.html#sect.apt-upgrade">قسم 6.2.3, “تحديث النظام”</a>).
			</div><div
            class="para">
				Let's suppose that <span
              class="distribution distribution">Stable</span> is your reference distribution but that <span
              class="distribution distribution">Testing</span> and <span
              class="distribution distribution">Unstable</span> are also listed in your <code
              class="filename">sources.list</code> file. In this case, you can use <code
              class="command">apt install <em
                class="replaceable">package</em>/testing</code> to install a package from <span
              class="distribution distribution">Testing</span>. If the installation fails due to some unsatisfiable dependencies, let it solve those dependencies within <span
              class="distribution distribution">Testing</span> by adding the <code
              class="literal">-t testing</code> parameter. The same obviously applies to <span
              class="distribution distribution">Unstable</span>.
			</div><div
            class="para">
				In this situation, upgrades (<code
              class="command">upgrade</code> and <code
              class="command">full-upgrade</code>) are done within <span
              class="distribution distribution">Stable</span> except for packages already upgraded to another distribution: those will follow updates available in the other distributions. We will explain this behavior with the help of the default priorities set by APT below. Do not hesitate to use <code
              class="command">apt-cache policy</code> (see sidebar) to verify the given priorities.
			</div><div
            class="para">
				يدور كل شيء حول حقيقة أن APT تنظر إلى الحزم ذات الأولويات الأعلى أو المساوية لأولويات الحزم المثبتة (بفرض أن <code
              dir="ltr"
              class="filename">/etc/apt/preferences</code> لم يُستخدم لفرض أولويات أعلى من 1000 لبعض الحزم).
			</div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>تلميح</em></span> <code
                        class="command">apt-cache policy</code></strong></p></div></div></div><div
              class="para">
				حتى تستوعب آلية الأولويات أكثر، لا تتردد بتنفيذ الأمر <code
                class="command">apt-cache policy</code> لعرض الأولويات الافتراضية المعينة لكل مصدر للحزم. يمكنك أيضاً استخدام <code
                class="command">apt-cache policy <em
                  class="replaceable">package</em></code> لعرض الأولويات لجميع النسخ المتوفرة لحزمة معينة.
			</div></div><div
            class="para">
				دعنا نفترض أنك تملك الإصدارة 1 مثبتة من حزمة أولى من التوزيعة <span
              class="distribution distribution">المستقرة</span> وأن الإصدارتين 2 و 3 متوفرتان على الترتيب في <span
              class="distribution distribution">الاختبارية</span> و<span
              class="distribution distribution">غير المستقرة</span>. للإصدارة المثبتة أولوية قدرها 100 لكن النسخة المتوفرة في <span
              class="distribution distribution">المستقرة</span> (الإصدارة نفسها) لها أولوية تساوي 990 (لأنها تنتمي للتوزيعة الهدف). تملك الحزم في <span
              class="distribution distribution">الاختبارية</span> و<span
              class="distribution distribution">غير المستقرة</span> أولوية قدرها 500 (الأولوية الافتراضية للإصدارات غير المثبتة). الرابح إذا هو الإصدار 1 صاحب الأولوية 990. إذاً ”تبقى الحزمة في التوزيعة <span
              class="distribution distribution">المستقرة</span>“.
			</div><div
            class="para">
				دعنا نأخذ مثالاً عن حزمة أخرى تم تثبيت الإصدار 2 منها من التوزيعة <span
              class="distribution distribution">الاختبارية</span>. والإصدار 1 متاح ضمن <span
              class="distribution distribution">المستقرة</span> والإصدار 3 ضمن <span
              class="distribution distribution">غير المستقرة</span>. يُهمَل الإصدار 1 (أولويته 990 – أي أنها أقل من 1000) لأنه أقدم من النسخة المثبتة. هذا يدع النسختين 2 و 3، ولكل منهما الأولوية 500. تختار APT الإصدار الأحدث، الذي ينتمي للتوزيعة <span
              class="distribution distribution">غير المستقرة</span>. إذا لم ترغب أن تهاجر الحزم المثبتة من <span
              class="distribution distribution">الاختبارية</span> إلى التوزيعة <span
              class="distribution distribution">غير المستقرة</span>، عليك تعيين أولوية أقل من 500 (490 مثلا) للحزم القادمة من <span
              class="distribution distribution">غير المستقرة</span>. يمكنك تعديل الملف <code
              dir="ltr"
              class="filename">/etc/apt/preferences</code> للوصول إلى هذه النتيجة:
			</div><pre
            class="programlisting">Package: *
Pin: release a=unstable
Pin-Priority: 490
</pre></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="sect.automatic-tracking"></a>6.2.7. متابعة الحزم المثبتة آلياً</h3></div></div></div><div
            class="para">
				One of the essential functionalities of <code
              class="command">apt</code> is the tracking of packages installed only through dependencies. These packages are called “automatic”, and often include libraries for instance.
			</div><div
            class="para">
				With this information, when packages are removed, the package managers can compute a list of automatic packages that are no longer needed (because there is no “manually installed” packages depending on them). <code
              class="command">apt-get autoremove</code> will get rid of those packages. <code
              class="command">aptitude</code> and <code
              class="command">apt</code> do not have this command: the former because it removes them automatically as soon as they are identified, and the latter probably because the user should not have to manually run such a command. In all cases, the tools display a clear message listing the affected packages.
			</div><a
            id="idm140241671889840"
            class="indexterm"></a><a
            id="idm140241671888720"
            class="indexterm"></a><a
            id="idm140241671887600"
            class="indexterm"></a><a
            id="idm140241671886480"
            class="indexterm"></a><div
            class="para">
				من الجيد تعليم أي حزمة لا تحتاجها بشكل مباشر على أنها آلية حتى تزال آلياً عندما لا تبقى لها ضرورة. سوف يضع الأمر <code
              class="command">apt-mark auto <em
                class="replaceable">package</em></code> علامة حزمة آلية على الحزمة المحددة، بينما الأمر <code
              class="command">apt-mark manual <em
                class="replaceable">package</em></code> يفعل العكس. يعمل الأمران <code
              class="command">aptitude markauto</code> و <code
              class="command">aptitude unmarkauto</code> بنفس الأسلوب، إلا أن لهما ميزات إضافية لتعليم عدة حزم دفعة واحدة (انظر <a
              class="xref"
              href="sect.apt-frontends.html#sect.aptitude">قسم 6.4.1, “‏<code
                class="command">aptitude</code>”</a>). كما أن الواجهة التفاعلية التي تقدمها <code
              class="command">aptitude</code> في الطرفية تُسهِّل مراجعة ”الأعلام الآلية automatic flag“ على أعداد كبيرة من الحزم.
			</div><a
            id="idm140241671880688"
            class="indexterm"></a><div
            class="para">
				People might want to know why an automatically installed package is present on the system. To get this information from the command line, you can use <code
              class="command">aptitude why <em
                class="replaceable">package</em></code> (<code
              class="command">apt</code> and <code
              class="command">apt-get</code> have no similar feature):
			</div><pre
            class="screen">$ <strong
              class="userinput"><code>aptitude why python-debian</code></strong>
i   aptitude         Recommends apt-xapian-index         
i A apt-xapian-index Depends    python-debian (&gt;= 0.1.15)
</pre><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>بدائل</em></span> <code
                        class="command">deborphan</code> و<code
                        class="command">debfoster</code></strong></p></div></div></div><a
              id="idm140241671874272"
              class="indexterm"></a><a
              id="idm140241671873152"
              class="indexterm"></a><div
              class="para">
				In days where <code
                class="command">apt</code>, <code
                class="command">apt-get</code> and <code
                class="command">aptitude</code> were not able to track automatic packages, there were two utilities producing lists of unnecessary packages: <code
                class="command">deborphan</code> and <code
                class="command">debfoster</code>.
			</div><div
              class="para">
				<code
                class="command">deborphan</code> is the most rudimentary of both. It simply scans the <code
                class="literal">libs</code> and <code
                class="literal">oldlibs</code> sections (in the absence of supplementary instructions) looking for the packages that are currently installed and that no other package depends on. The resulting list can then serve as a basis to remove unneeded packages.
			</div><div
              class="para">
				يتميز <code
                class="command">debfoster</code> بطريقة أكثر تطوراً، وقريبة جداً من أسلوب APT: فهو يحتفظ بلائحة بالحزم التي تم تثبيتها بشكل مقصود، ويتذكر الحزم التي اللازمة فعلاً بين كل استدعائين. إذا ظهرت حزم جديدة على النظام ولم يعرف <code
                class="command">debfoster</code> الأسباب التي تدعو لوجود تلك الحزم، سوف يظهرها على الشاشة مع اعتمادياتها. بعدها يقدم البرنامج لك عدة خيارات: إزالة الحزمة (مع الحزم التي تعتمد عليها أيضاً إذا أردت)، تعليم الحزمة على أنها حزمة مطلوبة صراحة، أو تجاهلها مؤقتاً.
			</div></div></div></div><ul
        class="docnav"><li
          class="previous"><a
            accesskey="p"
            href="apt.html"><strong>السابق</strong>فصل 6. الصيانة والتحديث: أدوات APT</a></li><li
          class="up"><a
            accesskey="u"
            href="#"><strong>أعلى</strong></a></li><li
          class="home"><a
            accesskey="h"
            href="index.html"><strong>البداية</strong></a></li><li
          class="next"><a
            accesskey="n"
            href="sect.apt-cache.html"><strong>التالي</strong>6.3. الأمر apt-cache</a></li></ul><div
        id="translated_pages"><ul><li><a
              href="../ar-MA/sect.apt-get.html">ar-MA</a></li><li><a
              href="../da-DK/sect.apt-get.html">da-DK</a></li><li><a
              href="../de-DE/sect.apt-get.html">de-DE</a></li><li><a
              href="../el-GR/sect.apt-get.html">el-GR</a></li><li><a
              href="../en-US/sect.apt-get.html">en-US</a></li><li><a
              href="../es-ES/sect.apt-get.html">es-ES</a></li><li><a
              href="../fa-IR/sect.apt-get.html">fa-IR</a></li><li><a
              href="../fr-FR/sect.apt-get.html">fr-FR</a></li><li><a
              href="../hr-HR/sect.apt-get.html">hr-HR</a></li><li><a
              href="../id-ID/sect.apt-get.html">id-ID</a></li><li><a
              href="../it-IT/sect.apt-get.html">it-IT</a></li><li><a
              href="../ja-JP/sect.apt-get.html">ja-JP</a></li><li><a
              href="../pl-PL/sect.apt-get.html">pl-PL</a></li><li><a
              href="../pt-BR/sect.apt-get.html">pt-BR</a></li><li><a
              href="../ro-RO/sect.apt-get.html">ro-RO</a></li><li><a
              href="../ru-RU/sect.apt-get.html">ru-RU</a></li><li><a
              href="../tr-TR/sect.apt-get.html">tr-TR</a></li><li><a
              href="../zh-CN/sect.apt-get.html">zh-CN</a></li></ul></div></body></html>
