<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"><head><meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8" /><title
        xmlns:d="http://docbook.org/ns/docbook">6.2. aptitude, apt-get, and apt Commands</title><link
        rel="stylesheet"
        type="text/css"
        href="Common_Content/css/default.css" /><link
        rel="stylesheet"
        media="print"
        href="Common_Content/css/print.css"
        type="text/css" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="generator"
        content="publican v4.3.2" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="package"
        content="Debian-debian-handbook-8-it-IT-1.0-1" /><meta
        name="keywords"
        content="apt, apt-get, apt-cache, aptitude, synaptic, sources.list, apt-cdrom" /><link
        rel="home"
        href="index.html"
        title="Il manuale dell'amministratore Debian" /><link
        rel="up"
        href="apt.html"
        title="Capitolo 6. Manutenzione ed aggiornamento: gli strumenti APT" /><link
        rel="prev"
        href="apt.html"
        title="Capitolo 6. Manutenzione ed aggiornamento: gli strumenti APT" /><link
        rel="next"
        href="sect.apt-cache.html"
        title="6.3. Il comando apt-cache" /><link
        rel="canonical"
        href="http://l.github.io/debian-handbook/html/it-IT/sect.apt-get.html" /></head><body
      class="draft "><noscript><iframe
          src="//www.googletagmanager.com/ns.html?id=GTM-5H35QX"
          height="0"
          width="0"
          style="display:none;visibility:hidden"></iframe></noscript><script
        type="text/javascript">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&amp;l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5H35QX');</script><div
        id="banner"><a
          href="http://debian-handbook.info/get/"><span
            class="text">Download the ebook</span></a></div><p
        id="title"><a
          class="left"
          href="http://www.debian.org"><img
            alt="Product Site"
            src="Common_Content/images//image_left.png" /></a><a
          class="right"
          href="http://debian-handbook.info"><img
            alt="Documentation Site"
            src="Common_Content/images//image_right.png" /></a></p><ul
        class="docnav top"><li
          class="previous"><a
            accesskey="p"
            href="apt.html"><strong>Indietro</strong></a></li><li
          class="home">Il manuale dell'amministratore Debian</li><li
          class="next"><a
            accesskey="n"
            href="sect.apt-cache.html"><strong>Avanti</strong></a></li></ul><div
        class="section"><div
          class="titlepage"><div><div><h2
                class="title"><a
                  id="sect.apt-get"></a>6.2. <code
                  class="command">aptitude</code>, <code
                  class="command">apt-get</code>, and <code
                  class="command">apt</code> Commands</h2></div></div></div><a
          id="idm140253706127328"
          class="indexterm"></a><a
          id="idm140253706126208"
          class="indexterm"></a><a
          id="idm140253706125088"
          class="indexterm"></a><div
          class="para">
			APT is a vast project, whose original plans included a graphical interface. It is based on a library which contains the core application, and <code
            class="command">apt-get</code> is the first front end — command-line based — which was developed within the project. <code
            class="command">apt</code> is a second command-line based front end provided by APT which overcomes some design mistakes of <code
            class="command">apt-get</code>.
		</div><div
          class="para">
			Numerous other graphical interfaces then appeared as external projects: <code
            class="command">synaptic</code>, <code
            class="command">aptitude</code> (which includes both a text mode interface and a graphical one — even if not complete yet), <code
            class="command">wajig</code>, etc. The most recommended interface, <code
            class="command">apt</code>, is the one that we will use in the examples given in this section. Note however that <code
            class="command">apt-get</code> and <code
            class="command">aptitude</code> have a very similar command line syntax. When there are major differences between <code
            class="command">apt</code>, <code
            class="command">apt-get</code> and <code
            class="command">aptitude</code>, these differences will be detailed.
		</div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="idm140253706117040"></a>6.2.1. Inizializzazione</h3></div></div></div><div
            class="para">
				For any work with APT, the list of available packages needs to be updated; this can be done simply through <code
              class="command">apt update</code>. Depending on the speed of your connection, the operation can take a while since it involves downloading a certain number of <code
              class="filename">Packages</code>/<code
              class="filename">Sources</code>/<code
              class="filename">Translation-<em
                class="replaceable">language-code</em></code> files, which have gradually become bigger and bigger as Debian has developed (at least 10 MB of data for the <code
              class="literal">main</code> section). Of course, installing from a CD-ROM set does not require any downloading — in this case, the operation is very fast.
			</div><a
            id="idm140253706112624"
            class="indexterm"></a><a
            id="idm140253706111504"
            class="indexterm"></a><a
            id="idm140253706110384"
            class="indexterm"></a></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="idm140253706109104"></a>6.2.2. Installazione e rimozione</h3></div></div></div><a
            id="idm140253706108336"
            class="indexterm"></a><a
            id="idm140253706106896"
            class="indexterm"></a><a
            id="idm140253706105456"
            class="indexterm"></a><a
            id="idm140253706104048"
            class="indexterm"></a><div
            class="para">
				With APT, packages can be added or removed from the system, respectively with <code
              class="command">apt install <em
                class="replaceable">package</em></code> and <code
              class="command">apt remove <em
                class="replaceable">package</em></code>. In both cases, APT will automatically install the necessary dependencies or delete the packages which depend on the package that is being removed. The <code
              class="command">apt purge <em
                class="replaceable">package</em></code> command involves a complete uninstallation — the configuration files are also deleted.
			</div><a
            id="idm140253706100048"
            class="indexterm"></a><a
            id="idm140253706098928"
            class="indexterm"></a><a
            id="idm140253706097808"
            class="indexterm"></a><a
            id="idm140253706096688"
            class="indexterm"></a><a
            id="idm140253706095568"
            class="indexterm"></a><a
            id="idm140253706094448"
            class="indexterm"></a><a
            id="idm140253706093328"
            class="indexterm"></a><a
            id="idm140253706092208"
            class="indexterm"></a><a
            id="idm140253706091088"
            class="indexterm"></a><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>SUGGERIMENTO</em></span> Installare la stessa selezione di pacchetti diverse volte</strong></p></div></div></div><div
              class="para">
				Può risultare utile installare sistematicamente la stessa lista di pacchetti su diversi computer. Ciò può essere fatto abbastanza facilmente.
			</div><div
              class="para">
				Prima di tutto, ottenere la lista dei pacchetti installati sul computer che servirà come «modello» da copiare.
			</div><pre
              class="screen"><code
                class="computeroutput">$ </code><strong
                class="userinput"><code>dpkg --get-selections &gt;pkg-list</code></strong></pre><div
              class="para">
				The <code
                class="filename">pkg-list</code> file then contains the list of installed packages. Next, transfer the <code
                class="filename">pkg-list</code> file onto the computers you want to update and use the following commands:
			</div><pre
              class="screen">## Aggiornare il database di dpkg dei pacchetti conosciuti
# <strong
                class="userinput"><code>avail=`mktemp`</code></strong>
# <strong
                class="userinput"><code>apt-cache dumpavail &gt; "$avail"</code></strong>
# <strong
                class="userinput"><code>dpkg --merge-avail "$avail"</code></strong>
# <strong
                class="userinput"><code>rm -f "$avail"</code></strong>
## Aggiornare le selezioni di dpkg
# <strong
                class="userinput"><code>dpkg --set-selections &lt; pkg-list</code></strong>
## Chiedere ad apt-get di installare i pacchetti selezionati
# <strong
                class="userinput"><code>apt-get dselect-upgrade</code></strong></pre><div
              class="para">
				Il primo comando registra la lista dei pacchetti disponibili nel database di dpkg, poi <code
                class="command">dpkg --set-selections</code> ripristina la selezione di pacchetti che si desidera installare, e l'invocazione di <code
                class="command">apt-get</code> esegue le operazioni necessarie! <code
                class="command">aptitude</code> non ha questo comando.
			</div></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>SUGGERIMENTO</em></span> Rimozione e installazione nello stesso momento</strong></p></div></div></div><div
              class="para">
				It is possible to ask <code
                class="command">apt</code> (or <code
                class="command">apt-get</code>, or <code
                class="command">aptitude</code>) to install certain packages and remove others on the same command line by adding a suffix. With an <code
                class="command">apt install</code> command, add “<code
                class="literal">-</code>” to the names of the packages you wish to remove. With an <code
                class="command">apt remove</code> command, add “<code
                class="literal">+</code>” to the names of the packages you wish to install.
			</div><div
              class="para">
				Il prossimo esempio mostra due modi differenti di installare il <em
                class="replaceable">pacchetto1</em> e rimuovere <em
                class="replaceable">pacchetto2</em>.
			</div><pre
              class="screen"># <strong
                class="userinput"><code>apt install <em
                    class="replaceable">package1</em> <em
                    class="replaceable">package2-</em></code></strong>
[...]
# <strong
                class="userinput"><code>apt remove <em
                    class="replaceable">package1+</em> <em
                    class="replaceable">package2</em></code></strong>
[...]
</pre><div
              class="para">
				Ciò può essere usato anche per escludere pacchetti che verrebbero altrimenti installati, per esempio a causa di una relazione <code
                class="literal">Recommends</code>. In generale il risolutore di dipendenze userà quella informazione come un invito a trovare soluzioni alternative.
			</div></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>TIP</em></span> <code
                        class="command">apt --reinstall</code> and <code
                        class="command">aptitude reinstall</code></strong></p></div></div></div><a
              id="idm140253706067104"
              class="indexterm"></a><div
              class="para">
				The system can sometimes be damaged after the removal or modification of files in a package. The easiest way to retrieve these files is to reinstall the affected package. Unfortunately, the packaging system finds that the latter is already installed and politely refuses to reinstall it; to avoid this, use the <code
                class="literal">--reinstall</code> option of the <code
                class="command">apt</code> and <code
                class="command">apt-get</code> commands. The following command reinstalls <span
                class="pkg pkg">postfix</span> even if it is already present:
			</div><pre
              class="screen"><code
                class="computeroutput"># </code><strong
                class="userinput"><code>apt --reinstall install postfix</code></strong></pre><div
              class="para">
				La riga di comando per <code
                class="command">aptitude</code> è un po' diversa, ma ottiene lo stesso risultato con <code
                class="command">aptitude reinstall postfix</code>.
			</div><div
              class="para">
				Il problema non si pone con <code
                class="command">dpkg</code>, ma raramente l'amministratore lo utilizza direttamente.
			</div><div
              class="para">
				Be careful! Using <code
                class="command">apt --reinstall</code> to restore packages modified during an attack will certainly not recover the system as it was. <a
                class="xref"
                href="sect.dealing-with-compromised-machine.html">Sezione 14.7, «Gestire una macchina compromessa»</a> details the necessary steps to take with a compromised system.
			</div></div><div
            class="para">
				If the file <code
              class="filename">sources.list</code> mentions several distributions, it is possible to give the version of the package to install. A specific version number can be requested with <code
              class="command">apt install <em
                class="replaceable">package</em>=<em
                class="replaceable">version</em></code>, but indicating its distribution of origin (<span
              class="distribution distribution">Stable</span>, <span
              class="distribution distribution">Testing</span> or <span
              class="distribution distribution">Unstable</span>) — with <code
              class="command">apt install <em
                class="replaceable">package</em>/<em
                class="replaceable">distribution</em></code> — is usually preferred. With this command, it is possible to go back to an older version of a package (if for instance you know that it works well), provided that it is still available in one of the sources referenced by the <code
              class="filename">sources.list</code> file. Otherwise the <code
              class="literal">snapshot.debian.org</code> archive can come to the rescue (see sidebar <a
              class="xref"
              href="apt.html#sidebar.snapshot.debian.org"><span
                class="emphasis"><em>APPROFONDIMENTO</em></span> Le vecchie versioni dei pacchetti: <code
                class="literal">snapshot.debian.org</code></a>).
			</div><div
            class="example"><a
              id="idm140253706050416"></a><p
              class="title"><strong>Esempio 6.3. Installazione della versione <span
                  class="distribution distribution">unstable</span> di <span
                  class="pkg pkg">spamassassin</span></strong></p><div
              class="example-contents"><pre
                class="screen"><code
                  class="computeroutput"># </code><strong
                  class="userinput"><code>apt install spamassassin/unstable</code></strong></pre></div></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>APPROFONDIMENTO</em></span> La cache dei file <code
                        class="filename">.deb</code></strong></p></div></div></div><div
              class="para">
				APT keeps a copy of each downloaded <code
                class="filename">.deb</code> file in the directory <code
                class="filename">/var/cache/apt/archives/</code>. In case of frequent updates, this directory can quickly take a lot of disk space with several versions of each package; you should regularly sort through them. Two commands can be used: <code
                class="command">apt-get clean</code> entirely empties the directory; <code
                class="command">apt-get autoclean</code> only removes packages which can no longer be downloaded (because they have disappeared from the Debian mirror) and are therefore clearly useless (the configuration parameter <code
                class="literal">APT::Clean-Installed</code> can prevent the removal of <code
                class="filename">.deb</code> files that are currently installed). Note that <code
                class="command">apt</code> does not support those commands.
			</div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="sect.apt-upgrade"></a>6.2.3. Aggiornamento del sistema</h3></div></div></div><a
            id="idm140253706040272"
            class="indexterm"></a><a
            id="idm140253706038864"
            class="indexterm"></a><a
            id="idm140253706037744"
            class="indexterm"></a><a
            id="idm140253706036624"
            class="indexterm"></a><div
            class="para">
				Regular upgrades are recommended, because they include the latest security updates. To upgrade, use <code
              class="command">apt upgrade</code>, <code
              class="command">apt-get upgrade</code> or <code
              class="command">aptitude safe-upgrade</code> (of course after <code
              class="command">apt update</code>). This command looks for installed packages which can be upgraded without removing any packages. In other words, the goal is to ensure the least intrusive upgrade possible. <code
              class="command">apt-get</code> is slightly more demanding than <code
              class="command">aptitude</code> or <code
              class="command">apt</code> because it will refuse to install packages which were not installed beforehand.
			</div><div
            class="sidebar"><a
              id="sidebar.apt-pdiff"></a><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>SUGGERIMENTO</em></span> Aggiornamento incrementale</strong></p></div></div></div><div
              class="para">
				As we explained earlier, the aim of the <code
                class="command">apt update</code> command is to download for each package source the corresponding <code
                class="filename">Packages</code> (or <code
                class="filename">Sources</code>) file. However, even after a <code
                class="command">bzip2</code> compression, these files can remain rather large (the <code
                class="filename">Packages.xz</code> for the <span
                class="foreignphrase"><em
                  class="foreignphrase">main</em></span> section of <span
                class="distribution distribution">Jessie</span> takes more than 6 MB). If you wish to upgrade regularly, these downloads can take up a lot of time.
			</div><div
              class="para">
				To speed up the process APT can download “diff” files containing the changes since the previous update, as opposed to the entire file. To achieve this, official Debian mirrors distribute different files which list the differences between one version of the <code
                class="filename">Packages</code> file and the following version. They are generated at each update of the archives and a history of one week is kept. Each of these “diff” files only takes a few dozen kilobytes for <span
                class="distribution distribution">Unstable</span>, so that the amount of data downloaded by a weekly <code
                class="command">apt update</code> is often divided by 10. For distributions like <span
                class="distribution distribution">Stable</span> and <span
                class="distribution distribution">Testing</span>, which change less, the gain is even more noticeable.
			</div><div
              class="para">
				Tuttavia, a volte può essere interessante forzare lo scaricamento di tutto il file <code
                class="filename">Packages</code>, specialmente quando l'ultimo aggiornamento è molto vecchio e quando il meccanismo di differenze incrementali non servirebbe a molto. Può essere anche interessante quando l'accesso alla rete è molto veloce ma il processore della macchina da aggiornare è piuttosto lento, poiché il risparmio di tempo nello scaricamento è più che perso quando il computer calcola le nuove versioni dei file (partendo dalle versioni più vecchie e applicando le differenze). Per fare questo, è possibile utilizzare il parametro di configurazione <code
                class="literal">Acquire::Pdiffs</code> e impostarlo a <code
                class="literal">false</code>.
			</div></div><div
            class="para">
				<code
              class="command">apt</code> will generally select the most recent version number (except for packages from <span
              class="distribution distribution">Experimental</span> and <span
              class="distribution distribution">stable-backports</span>, which are ignored by default whatever their version number). If you specified <span
              class="distribution distribution">Testing</span> or <span
              class="distribution distribution">Unstable</span> in your <code
              class="filename">sources.list</code>, <code
              class="command">apt upgrade</code> will switch most of your <span
              class="distribution distribution">Stable</span> system to <span
              class="distribution distribution">Testing</span> or <span
              class="distribution distribution">Unstable</span>, which might not be what you intended.
			</div><div
            class="para">
				To tell <code
              class="command">apt</code> to use a specific distribution when searching for upgraded packages, you need to use the <code
              class="literal">-t</code> or <code
              class="literal">--target-release</code> option, followed by the name of the distribution you want (for example: <code
              class="command">apt -t stable upgrade</code>). To avoid specifying this option every time you use <code
              class="command">apt</code>, you can add <code
              class="literal">APT::Default-Release "stable";</code> in the file <code
              class="filename">/etc/apt/apt.conf.d/local</code>.
			</div><a
            id="idm140253706007856"
            class="indexterm"></a><a
            id="idm140253706006736"
            class="indexterm"></a><a
            id="idm140253706005616"
            class="indexterm"></a><a
            id="idm140253706004496"
            class="indexterm"></a><a
            id="idm140253706003376"
            class="indexterm"></a><div
            class="para">
				For more important upgrades, such as the change from one major Debian version to the next, you need to use <code
              class="command">apt full-upgrade</code>. With this instruction, <code
              class="command">apt</code> will complete the upgrade even if it has to remove some obsolete packages or install new dependencies. This is also the command used by users who work daily with the Debian <span
              class="distribution distribution">Unstable</span> release and follow its evolution day by day. It is so simple that it hardly needs explanation: APT's reputation is based on this great functionality.
			</div><div
            class="para">
				Unlike <code
              class="command">apt</code> and <code
              class="command">aptitude</code>, <code
              class="command">apt-get</code> doesn't know the <code
              class="command">full-upgrade</code> command. Instead, you should use <code
              class="command">apt-get dist-upgrade</code> (”distribution upgrade”), the historical and well-known command that <code
              class="command">apt</code> and <code
              class="command">aptitude</code> also accept for the convenience of users who got used to it.
			</div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="sect.apt-config"></a>6.2.4. Opzioni di configurazione</h3></div></div></div><a
            id="idm140253705994544"
            class="indexterm"></a><a
            id="idm140253705993104"
            class="indexterm"></a><a
            id="idm140253705991984"
            class="indexterm"></a><div
            class="para">
				Besides the configuration elements already mentioned, it is possible to configure certain aspects of APT by adding directives in a file of the <code
              class="filename">/etc/apt/apt.conf.d/</code> directory. Remember for instance that it is possible for APT to tell <code
              class="command">dpkg</code> to ignore file conflict errors by specifying <code
              class="literal">DPkg::options { "--force-overwrite"; }</code>.
			</div><div
            class="para">
				Se si può accedere al Web solo attraverso proxy, bisogna aggiungere una riga come <code
              class="literal">Acquire::http::proxy "http://<em
                class="replaceable">proprioproxy</em>:3128"</code>. Per un proxy FTP, scrivere <code
              class="literal">Acquire::ftp::proxy "ftp://<em
                class="replaceable">proprioproxy</em>"</code>. Per scoprire più opzioni di configurazione, leggere la pagina di manuale <span
              class="citerefentry"><span
                class="refentrytitle">apt.conf</span>(5)</span> con il comando <code
              class="command">man apt.conf</code> (per i dettagli sulle pagine del manuale, vedere la <a
              class="xref"
              href="solving-problems.html#sect.manual-pages">Sezione 7.1.1, «Pagine di manuale»</a>).
			</div><div
            class="sidebar"><a
              id="sidebar.directory.d"></a><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>FONDAMENTALI</em></span> Directory terminanti in <code
                        class="filename">.d</code></strong></p></div></div></div><a
              id="idm140253705982512"
              class="indexterm"></a><div
              class="para">
				Le directory con il suffisso <code
                class="filename">.d</code> vengono utilizzate sempre più spesso. Ogni directory rappresenta un file di configurazione che viene suddiviso in più file. In questo senso, tutti i file in <code
                class="filename">/etc/apt/apt.conf.d/</code> sono istruzioni per la configurazione di APT. APT li include in ordine alfabetico, così che gli ultimi file possono modificare un elemento di configurazione definito in uno dei primi.
			</div><div
              class="para">
				Questa struttura offre una certa flessibilità all'amministratore della macchina e ai manutentori dei pacchetti. In effetti, l'amministratore può modificare facilmente la configurazione del software aggiungendo un file già pronto nella directory in questione senza dover modificare un file esistente. I manutentori dei pacchetti utilizzano lo stesso approccio quando hanno bisogno di adattare la configurazione di un altro software per assicurarsi che coesista perfettamente con il loro. La politica di Debian proibisce esplicitamente la modifica dei file di configurazione di altri pacchetti: solo gli utenti sono autorizzati a farlo. Ricordare che durante l'aggiornamento di un pacchetto, l'utente può scegliere la versione del file di configurazione che deve essere mantenuta quando viene rilevata una modifica. Qualsiasi modifica esterna del file innescherebbe questa richiesta, che disturberebbe l'amministratore, il quale è sicuro di non aver cambiato nulla.
			</div><div
              class="para">
				Without a <code
                class="filename">.d</code> directory, it is impossible for an external package to change the settings of a program without modifying its configuration file. Instead it must invite the user to do it themselves and lists the operations to be done in the file <code
                class="filename">/usr/share/doc/<em
                  class="replaceable">package</em>/README.Debian</code>.
			</div><div
              class="para">
				A seconda dell'applicazione, la directory <code
                class="filename">.d</code> è usata direttamente o gestita da uno script esterno che collega tutti i file per creare il file di configurazione stesso. È importante eseguire lo script dopo ogni cambiamento in quella directory in modo che le più recenti modifiche siano prese in considerazione. Allo stesso modo, è importante non lavorare direttamente sul file di configurazione creato automaticamente, dal momento ogni modifica andrebbe persa alla successiva esecuzione dello script. Il metodo scelto (la directory <code
                class="filename">.d</code> usata direttamente o un file generato da quella directory) è solitamente imposto da vincoli di implementazione, ma in entrambi i casi i guadagni in termini di flessibilità di configurazione sono maggiori rispetto alle piccole complicazioni che comportano. Il server di posta Exim 4 è un esempio del metodo del file generato: può essere configurato attraverso diversi file (<code
                class="filename">/etc/exim4/conf.d/*</code>) che sono concatenati in <code
                class="filename">/var/lib/exim4/config.autogenerated</code> dal comando <code
                class="command">update-exim4.conf</code>.
			</div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="sect.apt.priorities"></a>6.2.5. Gestire le priorità dei pacchetti</h3></div></div></div><div
            class="para">
				Uno degli aspetti più importanti nella configurazione di APT è la gestione delle priorità assegnate ad ogni fonte di pacchetti. Per esempio, si potrebbe volere estendere una distribuzione con uno o due pacchetti più nuovi da <span
              class="distribution distribution">Testing</span>, <span
              class="distribution distribution">Unstable</span> o <span
              class="distribution distribution">Experimental</span>. È possibile assegnare una priorità a ciascun pacchetto disponibile (lo stesso pacchetto può avere diverse priorità a seconda della sua versione o della distribuzione che lo fornisce). Queste priorità influenzeranno il comportamento di APT: per ogni pacchetto, selezionerà sempre la versione con la priorità più alta (tranne se questa è più vecchia di quella installata e se la sua priorità è inferiore a 1000).
			</div><a
            id="idm140253705967536"
            class="indexterm"></a><a
            id="idm140253705965936"
            class="indexterm"></a><a
            id="idm140253705964976"
            class="indexterm"></a><a
            id="idm140253705963536"
            class="indexterm"></a><a
            id="idm140253705962096"
            class="indexterm"></a><a
            id="idm140253705960656"
            class="indexterm"></a><a
            id="idm140253705959536"
            class="indexterm"></a><div
            class="para">
				APT definisce diverse priorità predefinite. Ogni versione installata di un pacchetto ha priorità 100. Una versione non installata ha priorità 500 per impostazione predefinita, ma può arrivare a 990 se è parte del rilascio di destinazione prescelto (definito con l'opzione a riga di comando <code
              class="literal">-t</code> o con la direttiva di configurazione <code
              class="literal">APT::Default-Release</code>).
			</div><div
            class="para">
				È possibile modificare le priorità con l'aggiunta di voci nel file <code
              class="filename">/etc/apt/preferences</code> con i nomi dei pacchetti interessati, la loro versione, la loro origine e la loro nuova priorità.
			</div><div
            class="para">
				APT non installerà mai una versione più vecchia di un pacchetto (cioè un pacchetto il cui numero di versione è più basso di quello del pacchetto attualmente installato) tranne se la sua priorità è superiore a 1000. APT installerà sempre il pacchetto con priorità più alta che soddisfa questa regola. Se due pacchetti hanno la stessa priorità, APT installerà il più recente (quello con numero di versione più alto). Se due pacchetti hanno le stesse versione e priorità ma diverso contenuto, APT installerà la versione non installata (questa regola è stata creata per coprire il caso di un aggiornamento di pacchetto senza incremento del numero di revisione, che normalmente è richiesto).
			</div><div
            class="para">
				Più in concreto, non sarà mai installato un pacchetto la cui priorità è minore di 0. Un pacchetto con priorità compresa tra 0 e 100 verrà installato solo se nessun'altra versione del pacchetto è già installata. Con una priorità da 100 a 500, il pacchetto sarà installato solo se non c'è un'altra versione più recente installata o disponibile in un'altra distribuzione. Un pacchetto con priorità fra 501 e 990 verrà installato solo se non ci sono nuove versioni installate o disponibili nella distribuzione di riferimento. Con una priorità da 990 a 1000, il pacchetto verrà installato a meno che la versione installata non è più recente. Una priorità superiore a 1000 porterà sempre all'installazione del pacchetto anche se costringe APT a retrocedere ad una versione precedente.
			</div><div
            class="para">
				When APT checks <code
              class="filename">/etc/apt/preferences</code>, it first takes into account the most specific entries (often those specifying the concerned package), then the more generic ones (including for example all the packages of a distribution). If several generic entries exist, the first match is used. The available selection criteria include the package's name and the source providing it. Every package source is identified by the information contained in a <code
              class="filename">Release</code> file that APT downloads together with the <code
              class="filename">Packages</code> files. It specifies the origin (usually “Debian” for the packages of official mirrors, but it can also be a person's or an organization's name for third-party repositories). It also gives the name of the distribution (usually <span
              class="distribution distribution">Stable</span>, <span
              class="distribution distribution">Testing</span>, <span
              class="distribution distribution">Unstable</span> or <span
              class="distribution distribution">Experimental</span> for the standard distributions provided by Debian) together with its version (for example 8 for Debian <span
              class="distribution distribution">Jessie</span>). Let's have a look at its syntax through some realistic case studies of this mechanism.
			</div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>CASO SPECIFICO</em></span> Priorità di <span
                        class="distribution distribution">experimental</span></strong></p></div></div></div><a
              id="idm140253705944928"
              class="indexterm"></a><div
              class="para">
				Se si è elencato <span
                class="distribution distribution">Experimental</span> nel proprio file <code
                class="filename">sources.list</code>, i pacchetti corrispondenti non saranno quasi mai installati perché la loro priorità predefinita è 1. Questo naturalmente è un caso specifico, progettato per impedire agli utenti di installare pacchetti <span
                class="distribution distribution">Experimental</span> per errore. I pacchetti possono essere installati solo digitando <code
                class="command">aptitude install <em
                  class="replaceable">pacchetto</em>/experimental</code>; gli utenti che digitano questo comando non possono che essere consapevoli dei rischi che corrono. È sempre possibile (anche se <span
                class="emphasis"><em>non</em></span> consigliato) trattare i pacchetti <span
                class="distribution distribution">Experimental</span> come quelli di altre distribuzioni dando loro priorità 500. Questo viene fatto con una voce specifica in <code
                class="filename">/etc/apt/preferences</code>:
			</div><div
              class="informalexample"><pre
                class="programlisting">Package: *
Pin: release a=experimental
Pin-Priority: 500
</pre></div></div><div
            class="para">
				Supponiamo che si vogliano usare solamente i pacchetti della versione stabile di Debian. Quelli forniti in altre versioni non devono essere installati tranne se esplicitamente richiesto. Si dovrebbero scrivere le seguenti voci nel file <code
              class="filename">/etc/apt/preferences</code>:
			</div><div
            class="informalexample"><pre
              class="programlisting">Package: *
Pin: release a=stable
Pin-Priority: 900

Package: *
Pin: release o=Debian
Pin-Priority: -10
</pre></div><div
            class="para">
				<code
              class="literal">a=stable</code> definisce il nome della distribuzione selezionata. <code
              class="literal">o=Debian</code> limita l'impostazione ai pacchetti la cui origine è "Debian".
			</div><div
            class="para">
				Let's now assume that you have a server with several local programs depending on the version 5.14 of Perl and that you want to ensure that upgrades will not install another version of it. You could use this entry:
			</div><div
            class="informalexample"><pre
              class="programlisting">Package: perl
Pin: version 5.14*
Pin-Priority: 1001
</pre></div><div
            class="para">
				La documentazione di riferimento per questo file di configurazione è disponibile nella pagina di manuale <span
              class="citerefentry"><span
                class="refentrytitle">apt_preferences</span>(5)</span>, che è possibile visualizzare con <code
              class="command">man apt_preferences</code>.
			</div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>SUGGERIMENTO</em></span> Commenti in <code
                        class="filename">/etc/apt/preferences</code></strong></p></div></div></div><a
              id="idm140253705927808"
              class="indexterm"></a><a
              id="idm140253705926688"
              class="indexterm"></a><a
              id="idm140253705925568"
              class="indexterm"></a><div
              class="para">
				Non esiste una sintassi ufficiale per mettere dei commenti nel file <code
                class="filename">/etc/apt/preferences</code>, ma possono essere fornite alcune descrizioni testuali mettendo uno o più campi "<code
                class="literal">Explanation</code>" all'inizio di ogni voce:
			</div><div
              class="informalexample"><pre
                class="programlisting">Explanation: Il pacchetto xserver-xorg-video-intel fornito
Explanation: in experimental può essere usato tranquillamente
Package: xserver-xorg-video-intel
Pin: release a=experimental
Pin-Priority: 500
</pre></div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="sect.apt-mix-distros"></a>6.2.6. Lavorare con più distribuzioni</h3></div></div></div><div
            class="para">
				<code
              class="command">apt</code> being such a marvelous tool, it is tempting to pick packages coming from other distributions. For example, after having installed a <span
              class="distribution distribution">Stable</span> system, you might want to try out a software package available in <span
              class="distribution distribution">Testing</span> or <span
              class="distribution distribution">Unstable</span> without diverging too much from the system's initial state.
			</div><div
            class="para">
				Even if you will occasionally encounter problems while mixing packages from different distributions, <code
              class="command">apt</code> manages such coexistence very well and limits risks very effectively. The best way to proceed is to list all distributions used in <code
              class="filename">/etc/apt/sources.list</code> (some people always put the three distributions, but remember that <span
              class="distribution distribution">Unstable</span> is reserved for experienced users) and to define your reference distribution with the <code
              class="literal">APT::Default-Release</code> parameter (see <a
              class="xref"
              href="sect.apt-get.html#sect.apt-upgrade">Sezione 6.2.3, «Aggiornamento del sistema»</a>).
			</div><div
            class="para">
				Let's suppose that <span
              class="distribution distribution">Stable</span> is your reference distribution but that <span
              class="distribution distribution">Testing</span> and <span
              class="distribution distribution">Unstable</span> are also listed in your <code
              class="filename">sources.list</code> file. In this case, you can use <code
              class="command">apt install <em
                class="replaceable">package</em>/testing</code> to install a package from <span
              class="distribution distribution">Testing</span>. If the installation fails due to some unsatisfiable dependencies, let it solve those dependencies within <span
              class="distribution distribution">Testing</span> by adding the <code
              class="literal">-t testing</code> parameter. The same obviously applies to <span
              class="distribution distribution">Unstable</span>.
			</div><div
            class="para">
				In this situation, upgrades (<code
              class="command">upgrade</code> and <code
              class="command">full-upgrade</code>) are done within <span
              class="distribution distribution">Stable</span> except for packages already upgraded to another distribution: those will follow updates available in the other distributions. We will explain this behavior with the help of the default priorities set by APT below. Do not hesitate to use <code
              class="command">apt-cache policy</code> (see sidebar) to verify the given priorities.
			</div><div
            class="para">
				Tutto ruota intorno al fatto che APT considera solo i pacchetti con versione più alta o uguale a quella installata (assumendo che non è stato usato <code
              class="filename">/etc/apt/preferences</code> per forzare priorità più alte di 1000 per alcuni pacchetti).
			</div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>SUGGERIMENTO</em></span> <code
                        class="command">apt-cache policy</code></strong></p></div></div></div><div
              class="para">
				Per capire meglio il meccanismo delle priorità, si può eseguire senza esitazioni <code
                class="command">apt-cache policy</code> per visualizzare la priorità predefinita associata ad ogni fonte di pacchetti. È possibile inoltre usare <code
                class="command">apt-cache policy <em
                  class="replaceable">pacchetto</em></code> per vedere le priorità di tutte le versioni disponibili di un determinato pacchetto.
			</div></div><div
            class="para">
				Supponiamo di avere installato la versione 1 di un primo pacchetto da <span
              class="distribution distribution">Stable</span> e che le versioni 2 e 3 siano disponibili rispettivamente in <span
              class="distribution distribution">Testing</span> e <span
              class="distribution distribution">Unstable</span>. La versione installata ha una priorità di 100, ma la versione disponibile in <span
              class="distribution distribution">Stable</span> (la stessa) ha priorità 990 (perché fa parte della versione di riferimento). I pacchetti in <span
              class="distribution distribution">Testing</span> e <span
              class="distribution distribution">Unstable</span> hanno priorità 500 (la priorità predefinita per una versione non installata). Il vincitore è dunque la versione 1 con una priorità di 990. Il pacchetto «rimane in <span
              class="distribution distribution">Stable</span>».
			</div><div
            class="para">
				Prendiamo ora l'esempio di un altro pacchetto la cui versione 2 è stata installata da <span
              class="distribution distribution">Testing</span>. La versione 1 è disponibile in <span
              class="distribution distribution">Stable</span> e la versione 3 in <span
              class="distribution distribution">Unstable</span>. La versione 1 (di priorità 990, quindi minore di 1000) è scartata perché è più bassa della versione installata. Questo lascia in gioco solo le versioni 2 e 3, entrambe con priorità 500. Di fronte a questa alternativa, APT sceglie la versione più recente, quella da <span
              class="distribution distribution">Unstable</span>. Se non si desidera che un pacchetto installato da <span
              class="distribution distribution">Testing</span> venga migrato a <span
              class="distribution distribution">Unstable</span>, è necessario assegnare una priorità minore di 500 (490 ad esempio) ai pacchetti provenienti da <span
              class="distribution distribution">Unstable</span>. Si può modificare <code
              class="filename">/etc/apt/preferences</code> con queste righe:
			</div><pre
            class="programlisting">Package: *
Pin: release a=unstable
Pin-Priority: 490
</pre></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="sect.automatic-tracking"></a>6.2.7. Tenere traccia dei pacchetti installati automaticamente</h3></div></div></div><div
            class="para">
				One of the essential functionalities of <code
              class="command">apt</code> is the tracking of packages installed only through dependencies. These packages are called “automatic”, and often include libraries for instance.
			</div><div
            class="para">
				With this information, when packages are removed, the package managers can compute a list of automatic packages that are no longer needed (because there is no “manually installed” packages depending on them). <code
              class="command">apt-get autoremove</code> will get rid of those packages. <code
              class="command">aptitude</code> and <code
              class="command">apt</code> do not have this command: the former because it removes them automatically as soon as they are identified, and the latter probably because the user should not have to manually run such a command. In all cases, the tools display a clear message listing the affected packages.
			</div><a
            id="idm140253705880624"
            class="indexterm"></a><a
            id="idm140253705879504"
            class="indexterm"></a><a
            id="idm140253705878384"
            class="indexterm"></a><a
            id="idm140253705877264"
            class="indexterm"></a><div
            class="para">
				È buona abitudine marcare come automatico ogni pacchetto di cui non si ha direttamente bisogno, in modo che venga automaticamente rimosso quando non è più necessario. <code
              class="command">apt-mark auto <em
                class="replaceable">pacchetto</em></code> marca il pacchetto specificato come automatico, mentre <code
              class="command">apt-mark manual <em
                class="replaceable">pacchetto</em></code> fa l'opposto. <code
              class="command">aptitude markauto</code> e <code
              class="command">aptitude unmarkauto</code> funzionano nello stesso modo, anche se offrono più funzionalità per marcare molti pacchetti contemporaneamente (vedere la <a
              class="xref"
              href="sect.apt-frontends.html#sect.aptitude">Sezione 6.4.1, «<code
                class="command">aptitude</code>»</a>). L'interfaccia interattiva basata su console di <code
              class="command">aptitude</code> rende anche facile revisionare il «contrassegno automatico» per molti pacchetti.
			</div><a
            id="idm140253705871744"
            class="indexterm"></a><div
            class="para">
				People might want to know why an automatically installed package is present on the system. To get this information from the command line, you can use <code
              class="command">aptitude why <em
                class="replaceable">package</em></code> (<code
              class="command">apt</code> and <code
              class="command">apt-get</code> have no similar feature):
			</div><pre
            class="screen">$ <strong
              class="userinput"><code>aptitude why python-debian</code></strong>
i   aptitude         Raccomanda apt-xapian-index         
i A apt-xapian-index Dipende    python-debian (&gt;= 0.1.15)
</pre><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>ALTERNATIVA</em></span> <code
                        class="command">deborphan</code> e <code
                        class="command">debfoster</code></strong></p></div></div></div><a
              id="idm140253705865328"
              class="indexterm"></a><a
              id="idm140253705864208"
              class="indexterm"></a><div
              class="para">
				In days where <code
                class="command">apt</code>, <code
                class="command">apt-get</code> and <code
                class="command">aptitude</code> were not able to track automatic packages, there were two utilities producing lists of unnecessary packages: <code
                class="command">deborphan</code> and <code
                class="command">debfoster</code>.
			</div><div
              class="para">
				<code
                class="command">deborphan</code> is the most rudimentary of both. It simply scans the <code
                class="literal">libs</code> and <code
                class="literal">oldlibs</code> sections (in the absence of supplementary instructions) looking for the packages that are currently installed and that no other package depends on. The resulting list can then serve as a basis to remove unneeded packages.
			</div><div
              class="para">
				<code
                class="command">debfoster</code> ha un approccio più elaborato, molto simile a quello di APT: mantiene una lista dei pacchetti che sono stati installati esplicitamente, e ricorda quali pacchetti sono veramente necessari da un'esecuzione all'altra. Se nuovi pacchetti compaiono nel sistema e <code
                class="command">debfoster</code> non li conosce come pacchetti necessari, li visualizzerà sullo schermo insieme alla lista delle loro dipendenze. Il programma spesso offre una scelta: rimuovere il pacchetto (eventualmente insieme a ciò che dipende da esso), marcarlo come esplicitamente richiesto o ignorarlo temporaneamente.
			</div></div></div></div><ul
        class="docnav"><li
          class="previous"><a
            accesskey="p"
            href="apt.html"><strong>Indietro</strong>Capitolo 6. Manutenzione ed aggiornamento: gli st...</a></li><li
          class="up"><a
            accesskey="u"
            href="#"><strong>Risali</strong></a></li><li
          class="home"><a
            accesskey="h"
            href="index.html"><strong>Partenza</strong></a></li><li
          class="next"><a
            accesskey="n"
            href="sect.apt-cache.html"><strong>Avanti</strong>6.3. Il comando apt-cache</a></li></ul><div
        id="translated_pages"><ul><li><a
              href="../ar-MA/sect.apt-get.html">ar-MA</a></li><li><a
              href="../da-DK/sect.apt-get.html">da-DK</a></li><li><a
              href="../de-DE/sect.apt-get.html">de-DE</a></li><li><a
              href="../el-GR/sect.apt-get.html">el-GR</a></li><li><a
              href="../en-US/sect.apt-get.html">en-US</a></li><li><a
              href="../es-ES/sect.apt-get.html">es-ES</a></li><li><a
              href="../fa-IR/sect.apt-get.html">fa-IR</a></li><li><a
              href="../fr-FR/sect.apt-get.html">fr-FR</a></li><li><a
              href="../hr-HR/sect.apt-get.html">hr-HR</a></li><li><a
              href="../id-ID/sect.apt-get.html">id-ID</a></li><li><a
              href="../it-IT/sect.apt-get.html">it-IT</a></li><li><a
              href="../ja-JP/sect.apt-get.html">ja-JP</a></li><li><a
              href="../pl-PL/sect.apt-get.html">pl-PL</a></li><li><a
              href="../pt-BR/sect.apt-get.html">pt-BR</a></li><li><a
              href="../ro-RO/sect.apt-get.html">ro-RO</a></li><li><a
              href="../ru-RU/sect.apt-get.html">ru-RU</a></li><li><a
              href="../tr-TR/sect.apt-get.html">tr-TR</a></li><li><a
              href="../zh-CN/sect.apt-get.html">zh-CN</a></li></ul></div></body></html>
